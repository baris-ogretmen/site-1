<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Galaktik BÃ¶lme Akademisi - 5. SÄ±nÄ±f</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bc13fe;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #000;
            color: white;
            overflow: hidden;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }

        /* --- Uzay Arka PlanÄ± --- */
        .space-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at center, #1a1a2e 0%, #16213e 50%, #000000 100%);
        }
        .stars {
            position: absolute; width: 100%; height: 100%;
            background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgZmlsbD0ibm9uZSIvPjxjaXJjbGUgY3g9IjEwIiBjeT0iMTAiIHI9IjEiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI1MCIgcj0iMS41IiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+PGNpcmNsZSBjeD0iMzUwIiBjeT0iMzUwIiByPSIxIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC40Ii8+PC9zdmc+') repeat;
            animation: moveStars 100s linear infinite;
        }
        @keyframes moveStars { from {background-position: 0 0;} to {background-position: -1000px 1000px;} }

        /* --- Glassmorphism Paneller --- */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        /* --- Buton Efektleri --- */
        .btn-3d {
            transition: all 0.1s;
            position: relative;
            top: 0;
            box-shadow: 0 5px 0 rgba(0,0,0,0.5);
        }
        .btn-3d:active {
            top: 5px;
            box-shadow: 0 0 0 rgba(0,0,0,0);
        }

        /* --- TÃ¼rkiye UsulÃ¼ BÃ¶lme Ã‡izgisi --- */
        .tr-division {
            display: inline-flex;
            font-family: monospace;
            line-height: 1.2;
        }
        .tr-left {
            padding-right: 12px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            font-size: 3rem;
        }
        .tr-right {
            border-left: 4px solid white;
            border-bottom: 4px solid white;
            padding-left: 12px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-width: 80px;
        }
        .tr-divisor {
            border-bottom: 4px solid white;
            padding-bottom: 4px;
            margin-bottom: 4px;
            font-size: 2.5rem;
            color: #c084fc; /* Purple */
        }
        .tr-quotient {
            padding-top: 4px;
            font-size: 2.5rem;
            color: #4ade80; /* Green */
        }
        .tr-dividend {
            color: #60a5fa; /* Blue */
        }

        /* --- Animasyonlar --- */
        .float-anim { animation: float 4s ease-in-out infinite; }
        @keyframes float { 0% {transform: translateY(0);} 50% {transform: translateY(-10px);} 100% {transform: translateY(0);} }
        
        .pulse-anim { animation: pulse 2s infinite; }
        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);} 70% {box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);} 100% {box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);} }

        /* Slayt GeÃ§iÅŸleri */
        .slide-content { display: none; opacity: 0; transition: opacity 0.5s; }
        .slide-content.active { display: flex; opacity: 1; }

        /* Elma / Nesne Stilleri */
        .object-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; justify-items: center; }
        .apple { font-size: 2rem; transition: transform 0.3s; }
        .apple.grouped { opacity: 0.3; transform: scale(0.8); }
        .apple.remainder { animation: bounce 1s infinite; filter: drop-shadow(0 0 5px red); }
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }

    </style>
</head>
<body class="h-screen flex flex-col">

    <div class="space-bg"><div class="stars"></div></div>

    <!-- Tam Ekran TuÅŸu -->
    <button onclick="toggleFullScreen()" class="absolute top-4 right-4 z-50 p-2 bg-white/10 rounded-full hover:bg-white/20 transition">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg>
    </button>

    <!-- ANA MENÃœ -->
    <div id="screen-menu" class="flex-1 flex flex-col items-center justify-center p-6 text-center z-10">
        <div class="mb-8 float-anim">
            <h1 class="text-6xl md:text-8xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 filter drop-shadow-lg">
                BÃ–LME
            </h1>
            <h2 class="text-3xl md:text-5xl font-light text-white tracking-widest mt-2">AKADEMÄ°SÄ°</h2>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-2xl">
            <button onclick="startTutorial()" class="btn-3d glass rounded-2xl p-8 flex flex-col items-center group hover:bg-white/20">
                <span class="text-6xl mb-4 group-hover:scale-110 transition">ğŸ“š</span>
                <span class="text-2xl font-bold text-cyan-300">Konu AnlatÄ±mÄ±</span>
                <span class="text-sm text-gray-300 mt-2">SÄ±fÄ±rdan Ã–ÄŸren</span>
            </button>
            <button onclick="startGame()" class="btn-3d glass rounded-2xl p-8 flex flex-col items-center group hover:bg-white/20 bg-gradient-to-br from-purple-900/50 to-blue-900/50">
                <span class="text-6xl mb-4 group-hover:scale-110 transition">ğŸš€</span>
                <span class="text-2xl font-bold text-green-300">GÃ¶reve BaÅŸla</span>
                <span class="text-sm text-gray-300 mt-2">Bilgini Test Et</span>
            </button>
        </div>
        <p class="mt-8 text-gray-400 text-sm">5. SÄ±nÄ±f MÃ¼fredatÄ±na Uygundur</p>
    </div>

    <!-- KONU ANLATIMI EKRANI -->
    <div id="screen-tutorial" class="hidden flex-1 flex-col p-4 md:p-8 max-w-6xl mx-auto w-full z-10 relative">
        <!-- Progress Bar -->
        <div class="w-full bg-gray-700 h-2 rounded-full mb-6">
            <div id="progress-bar" class="bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full transition-all duration-500" style="width: 16%"></div>
        </div>

        <!-- Slaytlar Container -->
        <div class="flex-1 glass rounded-3xl p-6 relative overflow-hidden flex flex-col justify-center items-center text-center">
            
            <!-- SLAYT 1: GiriÅŸ -->
            <div id="slide-1" class="slide-content active flex-col items-center">
                <h2 class="text-4xl md:text-5xl font-bold text-yellow-400 mb-6">BÃ¶lme Nedir?</h2>
                <div class="text-xl md:text-2xl mb-8 leading-relaxed">
                    BÃ¶lme, bir sayÄ±yÄ± <span class="text-cyan-300 font-bold">eÅŸit gruplara</span> ayÄ±rmaktÄ±r.<br>
                    PaylaÅŸtÄ±rmak demektir.
                </div>
                <div class="bg-black/30 p-6 rounded-xl flex gap-8 items-center">
                    <div class="text-center">
                        <div class="text-5xl mb-2">ğŸğŸğŸğŸ</div>
                        <div class="text-5xl">ğŸğŸğŸğŸ</div>
                        <p class="mt-2 text-gray-400">8 Elma</p>
                    </div>
                    <div class="text-4xl text-gray-500">â¡ï¸</div>
                    <div class="text-center">
                        <div class="text-5xl mb-2">ğŸ§º ğŸ§º</div>
                        <p class="mt-2 text-gray-400">2 Sepete EÅŸit PaylaÅŸtÄ±r</p>
                    </div>
                    <div class="text-4xl text-gray-500">=</div>
                    <div class="text-center">
                        <div class="text-5xl font-bold text-green-400">4</div>
                        <p class="mt-2 text-green-300">Her sepete dÃ¼ÅŸen</p>
                    </div>
                </div>
            </div>

            <!-- SLAYT 2: Terimler -->
            <div id="slide-2" class="slide-content flex-col items-center w-full">
                <h2 class="text-4xl font-bold text-yellow-400 mb-8">Terimleri TanÄ±yalÄ±m</h2>
                <div class="flex flex-col md:flex-row items-center justify-center gap-12 w-full">
                    
                    <!-- GÃ¶rsel BÃ¶lme -->
                    <div class="tr-division transform scale-125">
                        <div class="tr-left tr-dividend">23</div>
                        <div class="tr-right">
                            <div class="tr-divisor">5</div>
                            <div class="tr-quotient">4</div>
                        </div>
                    </div>

                    <!-- AÃ§Ä±klamalar -->
                    <div class="grid grid-cols-1 gap-4 text-left">
                        <div class="flex items-center gap-3 bg-blue-900/40 p-3 rounded-lg border border-blue-500/30">
                            <span class="text-2xl">ğŸ”µ</span>
                            <div>
                                <strong class="text-blue-300 text-xl">BÃ¶lÃ¼nen (23)</strong>
                                <p class="text-sm text-gray-300">PastanÄ±n tamamÄ±. PaylaÅŸtÄ±rÄ±lan sayÄ±.</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 bg-purple-900/40 p-3 rounded-lg border border-purple-500/30">
                            <span class="text-2xl">ğŸŸ£</span>
                            <div>
                                <strong class="text-purple-300 text-xl">BÃ¶len (5)</strong>
                                <p class="text-sm text-gray-300">KaÃ§ kiÅŸiye paylaÅŸtÄ±rÄ±yoruz?</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 bg-green-900/40 p-3 rounded-lg border border-green-500/30">
                            <span class="text-2xl">ğŸŸ¢</span>
                            <div>
                                <strong class="text-green-300 text-xl">BÃ¶lÃ¼m (4)</strong>
                                <p class="text-sm text-gray-300">SonuÃ§! KiÅŸi baÅŸÄ± dÃ¼ÅŸen miktar.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SLAYT 3: Kalan Nedir? -->
            <div id="slide-3" class="slide-content flex-col items-center">
                <h2 class="text-4xl font-bold text-orange-400 mb-4">Kalan Nedir?</h2>
                <p class="text-xl mb-6">Bazen sayÄ±lar tam bÃ¶lÃ¼nmez. Artan sayÄ±ya <strong class="text-red-400">KALAN</strong> denir.</p>
                
                <div class="flex flex-col md:flex-row gap-8 items-center bg-black/20 p-6 rounded-2xl border border-white/10">
                    <div class="text-center">
                        <p class="mb-2 font-bold text-blue-300">14 Kurabiye (BÃ¶lÃ¼nen)</p>
                        <div class="object-grid w-48 mx-auto bg-gray-800/50 p-2 rounded">
                            <div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div>
                            <div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div>
                            <div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div><div class="apple">ğŸª</div>
                            <div class="apple text-red-500 animate-bounce">ğŸª</div><div class="apple text-red-500 animate-bounce">ğŸª</div>
                        </div>
                    </div>

                    <div class="text-3xl">Ã· 3 KiÅŸi =</div>

                    <div class="text-left">
                        <p class="text-lg">Herkes <strong>4</strong> tane alÄ±r.</p>
                        <p class="text-lg mt-2 text-red-400 font-bold border-2 border-red-500/50 p-2 rounded inline-block">2 tane artar! (Kalan)</p>
                    </div>
                </div>
                
                <div class="mt-6 flex items-center justify-center font-mono text-3xl">
                    <div class="flex flex-col items-center mr-4">
                        <span class="text-blue-300">14</span>
                    </div>
                    <div class="border-b-2 border-white pb-1 mb-1">
                         <span class="text-gray-400">- 12</span>
                    </div>
                    <div class="text-red-500 font-bold">02</div>
                    <span class="ml-2 text-sm text-gray-400">(Kalan)</span>
                </div>
            </div>

            <!-- SLAYT 4: ALTIN KURAL -->
            <div id="slide-4" class="slide-content flex-col items-center">
                <div class="animate-pulse text-6xl mb-4">âš ï¸</div>
                <h2 class="text-5xl font-bold text-red-500 mb-8 uppercase tracking-wider">AltÄ±n Kural</h2>
                
                <div class="bg-red-900/30 border-2 border-red-500 p-8 rounded-3xl relative">
                    <p class="text-3xl md:text-4xl font-bold text-white mb-4">
                        Kalan <span class="text-yellow-400"><</span> BÃ¶len
                    </p>
                    <p class="text-xl text-gray-200">
                        Kalan sayÄ±, ASLA bÃ¶lene eÅŸit veya bÃ¶lenden bÃ¼yÃ¼k olamaz!
                    </p>
                </div>

                <div class="mt-8 grid grid-cols-2 gap-8">
                    <div class="glass p-4 rounded-xl opacity-50">
                        <p class="text-red-400 font-bold">YANLIÅ âŒ</p>
                        <p>BÃ¶len: 5</p>
                        <p>Kalan: 6</p>
                        <p class="text-xs mt-2">(Kalan daha bÃ¼yÃ¼k olamaz, bÃ¶lmeye devam etmelisin!)</p>
                    </div>
                    <div class="glass p-4 rounded-xl border-2 border-green-500">
                        <p class="text-green-400 font-bold">DOÄRU âœ…</p>
                        <p>BÃ¶len: 5</p>
                        <p>Kalan: 3</p>
                        <p class="text-xs mt-2">(3 kÃ¼Ã§Ã¼ktÃ¼r 5'ten. Ä°ÅŸlem bitti.)</p>
                    </div>
                </div>
            </div>

            <!-- SLAYT 5: SaÄŸlama (Kontrol) -->
            <div id="slide-5" class="slide-content flex-col items-center">
                <h2 class="text-4xl font-bold text-purple-400 mb-6">Ä°ÅŸlemi Kontrol Et (SaÄŸlama)</h2>
                <p class="text-xl mb-8">Ä°ÅŸlemin doÄŸru mu? FormÃ¼lÃ¼ kullan!</p>

                <div class="bg-gradient-to-r from-blue-900 to-purple-900 p-6 rounded-2xl border border-white/20 mb-8">
                    <p class="text-xl md:text-3xl font-mono">
                        (<span class="text-green-400">BÃ¶lÃ¼m</span> x <span class="text-purple-400">BÃ¶len</span>) + <span class="text-red-400">Kalan</span> = <span class="text-blue-400">BÃ¶lÃ¼nen</span>
                    </p>
                </div>

                <div class="text-left w-full max-w-md bg-black/30 p-4 rounded-xl">
                    <p class="text-lg font-bold mb-2">Ã–rnek: 23 Ã· 5 = 4 (Kalan 3)</p>
                    <ul class="space-y-2 font-mono text-xl">
                        <li>1. <span class="text-green-400">4</span> x <span class="text-purple-400">5</span> = 20</li>
                        <li>2. 20 + <span class="text-red-400">3</span> = <span class="text-blue-400">23</span></li>
                        <li class="text-green-500 font-bold text-center mt-2">DOÄRU! âœ…</li>
                    </ul>
                </div>
            </div>

             <!-- SLAYT 6: HazÄ±r mÄ±sÄ±n? -->
             <div id="slide-6" class="slide-content flex-col items-center">
                <h2 class="text-5xl font-bold text-white mb-6">GÃ¶reve HazÄ±r MÄ±sÄ±n?</h2>
                <p class="text-xl text-gray-300 mb-8 max-w-xl">
                    Åimdi akademi simÃ¼lasyonuna gireceksin. <br>
                    Sorularda hem <strong>BÃ¶lÃ¼mÃ¼</strong> hem de varsa <strong>KalanÄ±</strong> doÄŸru girmelisin.
                </p>
                <div class="flex gap-4">
                    <button onclick="changeSlide(1)" class="px-6 py-3 rounded-xl bg-gray-600 hover:bg-gray-500 text-white">Tekrar Et</button>
                    <button onclick="startGame()" class="btn-3d px-12 py-4 rounded-xl bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold text-2xl">BAÅLA ğŸš€</button>
                </div>
            </div>

            <!-- Navigasyon ButonlarÄ± -->
            <div class="absolute bottom-6 left-0 w-full px-8 flex justify-between">
                <button id="prev-btn" onclick="prevSlide()" class="p-3 rounded-full bg-white/10 hover:bg-white/20 disabled:opacity-30">â¬…ï¸ Geri</button>
                <button id="next-btn" onclick="nextSlide()" class="p-3 rounded-full bg-white/10 hover:bg-white/20">Ä°leri â¡ï¸</button>
            </div>
        </div>
    </div>

    <!-- OYUN EKRANI -->
    <div id="screen-game" class="hidden flex-1 flex-col relative w-full h-full p-4">
        
        <!-- Oyun Ãœst Bilgi -->
        <div class="flex justify-between items-center mb-4 max-w-4xl mx-auto w-full glass p-3 rounded-xl">
            <div class="flex items-center gap-4">
                <div class="text-yellow-400 font-bold text-xl md:text-2xl">PUAN: <span id="score">0</span></div>
                <div class="text-blue-300 font-bold text-sm md:text-lg">SEVÄ°YE: <span id="level">1</span></div>
            </div>
            <div class="flex text-red-500 gap-1 text-2xl" id="lives">â¤ï¸â¤ï¸â¤ï¸</div>
        </div>

        <!-- Oyun AlanÄ± Container -->
        <div class="flex-1 flex flex-col lg:flex-row gap-4 max-w-5xl mx-auto w-full items-center justify-center min-h-0">
            
            <!-- Soru KartÄ± -->
            <div class="flex-1 w-full h-full max-h-[400px] glass rounded-3xl flex flex-col items-center justify-center relative bg-gradient-to-b from-slate-800/80 to-slate-900/80">
                
                <div id="game-message" class="absolute top-4 text-gray-400 text-sm font-bold tracking-widest">BÃ–LÃœMÃœ BUL</div>

                <!-- Soru GÃ¶rseli -->
                <div class="tr-division transform scale-150 mb-8">
                    <div id="g-dividend" class="tr-left tr-dividend">?</div>
                    <div class="tr-right">
                        <div id="g-divisor" class="tr-divisor">?</div>
                        <div id="g-quotient" class="tr-quotient min-w-[50px] min-h-[50px] border-2 border-dashed border-white/30 rounded flex items-center justify-center text-white bg-white/5">?</div>
                    </div>
                </div>

                <!-- Kalan Input AlanÄ± (BaÅŸlangÄ±Ã§ta gizli veya pasif) -->
                <div id="remainder-area" class="flex items-center gap-2 opacity-50 transition-all duration-300">
                    <span class="text-xl text-gray-400">Kalan:</span>
                    <div id="g-remainder" class="w-16 h-12 border-2 border-dashed border-red-500/30 rounded flex items-center justify-center text-red-400 font-bold text-2xl bg-black/20">?</div>
                </div>

                <!-- Bildirim -->
                <div id="feedback" class="absolute bottom-6 text-2xl font-bold h-8"></div>
            </div>

            <!-- Numpad -->
            <div class="w-full max-w-xs lg:max-w-sm">
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="inputNum(1)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">1</button>
                    <button onclick="inputNum(2)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">2</button>
                    <button onclick="inputNum(3)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">3</button>
                    
                    <button onclick="inputNum(4)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">4</button>
                    <button onclick="inputNum(5)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">5</button>
                    <button onclick="inputNum(6)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">6</button>
                    
                    <button onclick="inputNum(7)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">7</button>
                    <button onclick="inputNum(8)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">8</button>
                    <button onclick="inputNum(9)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">9</button>
                    
                    <button onclick="clearInput()" class="btn-3d bg-red-600/80 p-4 text-xl font-bold rounded-xl border-b-4 border-red-800">SÄ°L</button>
                    <button onclick="inputNum(0)" class="btn-3d glass p-4 text-3xl font-bold rounded-xl hover:bg-white/10">0</button>
                    <button onclick="submitAnswer()" class="btn-3d bg-green-600 p-4 text-xl font-bold rounded-xl border-b-4 border-green-800">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SONUÃ‡ EKRANI -->
    <div id="screen-end" class="hidden absolute top-0 left-0 w-full h-full bg-black/95 z-50 flex items-center justify-center p-4">
        <div class="glass p-8 rounded-3xl text-center max-w-md w-full border border-white/20">
            <h2 id="end-title" class="text-4xl font-bold mb-2">Oyun Bitti</h2>
            <div class="text-8xl my-6">ğŸ›¸</div>
            <div class="text-gray-400 mb-2">TOPLAM PUAN</div>
            <div id="final-score" class="text-6xl font-bold text-yellow-400 mb-8 neon-text">0</div>
            <button onclick="location.reload()" class="btn-3d w-full bg-purple-600 py-4 rounded-xl text-xl font-bold border-b-4 border-purple-800">Ana MenÃ¼ye DÃ¶n</button>
        </div>
    </div>

    <!-- Konfeti -->
    <canvas id="confetti" class="fixed top-0 left-0 pointer-events-none z-50"></canvas>

    <script>
        /* --- SES SÄ°STEMÄ° --- */
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTone(freq, type, duration) {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        /* --- DEÄÄ°ÅKENLER --- */
        let currentSlide = 1;
        const totalSlides = 6;
        
        let score = 0;
        let lives = 3;
        let level = 1;
        
        // Soru Verileri
        let qDividend = 0;
        let qDivisor = 0;
        let qQuotient = 0;
        let qRemainder = 0;
        
        // Oyun Durumu
        let inputBuffer = "";
        let inputPhase = "quotient"; // "quotient" (bÃ¶lÃ¼m) veya "remainder" (kalan)

        /* --- NAVIGATION --- */
        function toggleFullScreen() {
            if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(e=>{});
            else if(document.exitFullscreen) document.exitFullscreen();
        }

        function startTutorial() {
            document.getElementById('screen-menu').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.remove('hidden');
            document.getElementById('screen-tutorial').classList.add('flex');
            changeSlide(1);
        }

        function startGame() {
            document.getElementById('screen-menu').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.remove('flex');
            document.getElementById('screen-game').classList.remove('hidden');
            document.getElementById('screen-game').classList.add('flex');
            
            score = 0;
            lives = 3;
            level = 1;
            updateUI();
            generateQuestion();
        }

        /* --- TUTORIAL LOGIC --- */
        function changeSlide(n) {
            currentSlide = n;
            document.querySelectorAll('.slide-content').forEach(s => s.classList.remove('active'));
            document.getElementById(`slide-${n}`).classList.add('active');
            
            // Progress Bar
            const percent = (n / totalSlides) * 100;
            document.getElementById('progress-bar').style.width = `${percent}%`;

            // Buton durumlarÄ±
            document.getElementById('prev-btn').disabled = n === 1;
            document.getElementById('next-btn').style.display = n === totalSlides ? 'none' : 'block';
        }

        function nextSlide() { if(currentSlide < totalSlides) changeSlide(currentSlide + 1); }
        function prevSlide() { if(currentSlide > 1) changeSlide(currentSlide - 1); else location.reload(); }

        /* --- GAME LOGIC --- */
        function generateQuestion() {
            inputBuffer = "";
            inputPhase = "quotient"; // Ã–nce bÃ¶lÃ¼mÃ¼ sor
            
            // UI SÄ±fÄ±rla
            document.getElementById('g-quotient').textContent = "?";
            document.getElementById('g-quotient').className = "tr-quotient min-w-[50px] min-h-[50px] border-2 border-dashed border-white rounded flex items-center justify-center text-white bg-white/10 pulse-anim";
            
            document.getElementById('g-remainder').textContent = "?";
            document.getElementById('remainder-area').classList.add('opacity-50');
            document.getElementById('remainder-area').classList.remove('opacity-100');
            document.getElementById('g-remainder').classList.remove('pulse-anim', 'border-white', 'text-white');
            document.getElementById('g-remainder').classList.add('border-red-500/30', 'text-red-400');

            document.getElementById('game-message').textContent = "BÃ–LÃœMÃœ BUL";
            document.getElementById('game-message').className = "absolute top-4 text-green-400 text-sm font-bold tracking-widest";
            document.getElementById('feedback').textContent = "";

            // Zorluk AlgoritmasÄ±
            let minDiv, maxDiv, minQuot, maxQuot;
            
            // Her 3 soruda bir zorluk artar
            if (level === 1) { minDiv=2; maxDiv=5; minQuot=2; maxQuot=5; }
            else if (level === 2) { minDiv=3; maxDiv=9; minQuot=3; maxQuot=9; }
            else { minDiv=4; maxDiv=12; minQuot=5; maxQuot=15; }

            qDivisor = Math.floor(Math.random() * (maxDiv - minDiv + 1)) + minDiv;
            qQuotient = Math.floor(Math.random() * (maxQuot - minQuot + 1)) + minQuot;
            
            // %40 Ä°htimalle KalanlÄ± Sor
            const isRemainder = Math.random() < 0.4; 
            
            if (isRemainder) {
                // Kalan < BÃ¶len kuralÄ±na gÃ¶re rastgele bir kalan seÃ§
                qRemainder = Math.floor(Math.random() * (qDivisor - 1)) + 1; 
            } else {
                qRemainder = 0;
            }

            qDividend = (qDivisor * qQuotient) + qRemainder;

            document.getElementById('g-dividend').textContent = qDividend;
            document.getElementById('g-divisor').textContent = qDivisor;
        }

        function inputNum(n) {
            playTone(400, 'sine', 0.05);
            if (inputBuffer.length < 3) {
                inputBuffer += n;
                updateInputDisplay();
            }
        }

        function clearInput() {
            playTone(200, 'triangle', 0.1);
            inputBuffer = "";
            updateInputDisplay();
        }

        function updateInputDisplay() {
            if (inputPhase === "quotient") {
                document.getElementById('g-quotient').textContent = inputBuffer;
            } else {
                document.getElementById('g-remainder').textContent = inputBuffer;
            }
        }

        function submitAnswer() {
            if(inputBuffer === "") return;
            const val = parseInt(inputBuffer);

            if (inputPhase === "quotient") {
                // BÃ¶lÃ¼m KontrolÃ¼
                if (val === qQuotient) {
                    playTone(600, 'sine', 0.1); setTimeout(()=>playTone(800,'sine',0.1),100);
                    
                    // GÃ¶rseli gÃ¼ncelle (DoÄŸru girildi)
                    document.getElementById('g-quotient').className = "tr-quotient font-bold text-green-400 text-4xl";
                    document.getElementById('g-quotient').classList.remove('pulse-anim');
                    
                    // Åimdi KalanÄ± Sor
                    inputPhase = "remainder";
                    inputBuffer = "";
                    
                    document.getElementById('game-message').textContent = "ÅÄ°MDÄ° KALANI BUL";
                    document.getElementById('game-message').className = "absolute top-4 text-red-400 text-sm font-bold tracking-widest animate-pulse";
                    
                    // Kalan AlanÄ±nÄ± Aktif Et
                    document.getElementById('remainder-area').classList.remove('opacity-50');
                    document.getElementById('remainder-area').classList.add('opacity-100');
                    const remBox = document.getElementById('g-remainder');
                    remBox.classList.remove('border-red-500/30', 'text-red-400');
                    remBox.classList.add('border-white', 'text-white', 'pulse-anim');
                    remBox.textContent = "?";

                } else {
                    wrongAnswer();
                }
            } else {
                // Kalan KontrolÃ¼
                if (val === qRemainder) {
                    // TAM DOÄRU!
                    playTone(600, 'square', 0.1);
                    playTone(1000, 'square', 0.2);
                    
                    document.getElementById('g-remainder').classList.remove('pulse-anim');
                    document.getElementById('g-remainder').classList.add('text-green-400', 'border-green-400');
                    
                    score += 10 + (level * 2);
                    if (qRemainder > 0) score += 5; // KalanlÄ± soru bonusu

                    document.getElementById('feedback').textContent = "MÃœKEMMEL! ğŸŒŸ";
                    document.getElementById('feedback').className = "absolute bottom-6 text-2xl font-bold h-8 text-green-400";
                    
                    if(score % 50 === 0) level++;
                    updateUI();
                    
                    setTimeout(generateQuestion, 1500);
                } else {
                    wrongAnswer();
                }
            }
        }

        function wrongAnswer() {
            playTone(150, 'sawtooth', 0.3);
            lives--;
            updateUI();
            
            const el = inputPhase === "quotient" ? document.getElementById('g-quotient') : document.getElementById('g-remainder');
            el.classList.add('animate-shake');
            document.getElementById('feedback').textContent = "YANLIÅ, TEKRAR DENE!";
            document.getElementById('feedback').className = "absolute bottom-6 text-2xl font-bold h-8 text-red-500";
            
            setTimeout(() => {
                el.classList.remove('animate-shake');
                inputBuffer = "";
                updateInputDisplay();
                document.getElementById('feedback').textContent = "";
            }, 500);

            if (lives <= 0) endGame();
        }

        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            
            let hearts = "";
            for(let i=0; i<lives; i++) hearts += "â¤ï¸";
            document.getElementById('lives').textContent = hearts;
        }

        function endGame() {
            document.getElementById('screen-game').classList.add('hidden');
            document.getElementById('screen-end').classList.remove('hidden');
            document.getElementById('final-score').textContent = score;
            if(score > 100) {
                document.getElementById('end-title').textContent = "MATEMATÄ°K DAHÄ°SÄ°! ğŸ†";
                startConfetti();
            }
        }

        /* --- CONFETTI --- */
        function startConfetti() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const particles = Array.from({length:100}, () => ({
                x: Math.random()*canvas.width, y: Math.random()*canvas.height-canvas.height,
                vx: Math.random()*4-2, vy: Math.random()*4+2,
                c: `hsl(${Math.random()*360},100%,50%)`
            }));
            function loop(){
                ctx.clearRect(0,0,canvas.width,canvas.height);
                particles.forEach(p=>{
                    p.x+=p.vx; p.y+=p.vy;
                    if(p.y>canvas.height) p.y=-10;
                    ctx.fillStyle=p.c; ctx.fillRect(p.x,p.y,8,8);
                });
                requestAnimationFrame(loop);
            }
            loop();
        }
        
        // CSS Shake Animasyonu iÃ§in style ekle
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }
            .animate-shake { animation: shake 0.3s; border-color: red !important; color: red !important; }
        `;
        document.head.appendChild(style);

    </script>
</body>
</html>

