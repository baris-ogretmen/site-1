<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Galaktik B√∂lme - Akƒ±llƒ± Sorular</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bc13fe;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #000;
            color: white;
            overflow: hidden;
            touch-action: none; 
            user-select: none;
            -webkit-user-select: none;
        }

        .space-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at center, #1a1a2e 0%, #16213e 50%, #000000 100%);
        }
        .stars {
            position: absolute; width: 100%; height: 100%;
            background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgZmlsbD0ibm9uZSIvPjxjaXJjbGUgY3g9IjEwIiBjeT0iMTAiIHI9IjEiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjUiLz48Y2lyY2xlIGN4PSIyMDAiIGN5PSI1MCIgcj0iMS41IiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC43Ii8+PGNpcmNsZSBjeD0iMzUwIiBjeT0iMzUwIiByPSIxIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC40Ii8+PC9zdmc+') repeat;
            opacity: 0.5;
        }

        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .btn-3d {
            transition: all 0.1s;
            position: relative;
            top: 0;
            box-shadow: 0 5px 0 rgba(0,0,0,0.5);
            cursor: pointer;
        }
        .btn-3d:active {
            top: 5px;
            box-shadow: 0 0 0 rgba(0,0,0,0);
        }

        /* T√ºrkiye Usul√º B√∂lme */
        .tr-division { display: inline-flex; font-family: monospace; line-height: 1.2; }
        .tr-left { padding-right: 12px; display: flex; align-items: center; justify-content: flex-end; font-size: 3rem; }
        .tr-right { border-left: 4px solid white; border-bottom: 4px solid white; padding-left: 12px; display: flex; flex-direction: column; justify-content: space-between; min-width: 80px; }
        .tr-divisor { border-bottom: 4px solid white; padding-bottom: 4px; margin-bottom: 4px; font-size: 2.5rem; color: #c084fc; }
        .tr-quotient { padding-top: 4px; font-size: 2.5rem; color: #4ade80; }
        .tr-dividend { color: #60a5fa; }

        .pulse-anim { animation: pulse 2s infinite; }
        @keyframes pulse { 0% {box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.4);} 70% {box-shadow: 0 0 0 10px rgba(255, 255, 255, 0);} 100% {box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);} }
        
        .slide-content { display: none; opacity: 0; transition: opacity 0.5s; }
        .slide-content.active { display: flex; opacity: 1; }

        /* Canvas (√áizim Alanƒ±) */
        #drawing-board {
            touch-action: none;
            cursor: crosshair;
            background-color: rgba(20, 30, 40, 0.6);
            border-radius: 1rem;
        }
        .tool-active { background-color: #4ade80 !important; color: black !important; border-color: #4ade80 !important; }

        /* Layout */
        .game-layout { display: flex; gap: 1rem; height: 100%; width: 100%; overflow: hidden; }
        .game-panel { flex: 1; display: flex; flex-direction: column; transition: all 0.3s; }
        .board-panel { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            background: rgba(0,0,0,0.3); 
            border: 2px dashed rgba(255,255,255,0.2); 
            border-radius: 1rem; 
            padding: 0.5rem;
            position: relative;
        }

        @media (max-width: 1024px) {
            .game-layout { position: relative; }
            .board-panel { 
                position: absolute; 
                top: 0; left: 0; width: 100%; height: 100%; 
                z-index: 50; 
                background: rgba(10, 10, 20, 0.95); 
                display: none; 
            }
            .board-panel.show { display: flex; }
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <div class="space-bg"><div class="stars"></div></div>

    <button onclick="toggleFullScreen()" class="absolute top-4 right-4 z-50 p-2 bg-white/10 rounded-full hover:bg-white/20 transition">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path></svg>
    </button>

    <!-- MEN√ú -->
    <div id="screen-menu" class="flex-1 flex flex-col items-center justify-center p-6 text-center z-10">
        <h1 class="text-6xl md:text-8xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 mb-2">B√ñLME</h1>
        <h2 class="text-3xl md:text-5xl font-light text-white tracking-widest mb-12">AKADEMƒ∞Sƒ∞</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full max-w-2xl">
            <button onclick="startTutorial()" class="btn-3d glass rounded-2xl p-8 flex flex-col items-center group hover:bg-white/20">
                <span class="text-6xl mb-4">üìö</span>
                <span class="text-2xl font-bold text-cyan-300">Konu Anlatƒ±mƒ±</span>
            </button>
            <button onclick="startGame()" class="btn-3d glass rounded-2xl p-8 flex flex-col items-center group hover:bg-white/20 bg-gradient-to-br from-purple-900/50 to-blue-900/50">
                <span class="text-6xl mb-4">üöÄ</span>
                <span class="text-2xl font-bold text-green-300">G√∂reve Ba≈üla</span>
            </button>
        </div>
    </div>

    <!-- KONU ANLATIMI -->
    <div id="screen-tutorial" class="hidden flex-1 flex-col p-4 md:p-8 max-w-6xl mx-auto w-full z-10 relative">
        <div class="w-full bg-gray-700 h-2 rounded-full mb-6">
            <div id="progress-bar" class="bg-gradient-to-r from-cyan-400 to-purple-500 h-2 rounded-full transition-all duration-500" style="width: 25%"></div>
        </div>
        <div class="flex-1 glass rounded-3xl p-6 relative overflow-hidden flex flex-col justify-center items-center text-center">
            
            <div id="slide-1" class="slide-content active flex-col items-center">
                <h2 class="text-4xl font-bold text-yellow-400 mb-6">B√∂lme Nedir?</h2>
                <div class="text-xl mb-4">Bir b√ºt√ºn√º e≈ü par√ßalara ayƒ±rmaktƒ±r.</div>
                <div class="text-6xl mb-4">üçéüçéüçéüçé</div>
                <div class="text-2xl">4 Elma √∑ 2 Ki≈üi = <span class="text-green-400 font-bold">2 Elma</span></div>
            </div>
            
            <div id="slide-2" class="slide-content flex-col items-center">
                <h2 class="text-4xl font-bold text-yellow-400 mb-6">Kalanlƒ± B√∂lme</h2>
                <p class="text-xl mb-4">Bazen elmalar tam b√∂l√ºnmez. Artan sayƒ±ya <strong>KALAN</strong> denir.</p>
                <div class="bg-black/40 p-4 rounded-xl text-left font-mono text-2xl inline-block">
                    <p>13 √∑ 4 = ?</p>
                    <p class="text-sm text-gray-400 mt-2">13'√ºn i√ßinde 4, 3 kere var (4, 8, 12).</p>
                    <p>13 - 12 = <span class="text-red-400 font-bold">1 (Kalan)</span></p>
                </div>
            </div>

            <div id="slide-3" class="slide-content flex-col items-center">
                <h2 class="text-4xl font-bold text-red-500 mb-6">Altƒ±n Kural</h2>
                <div class="border-4 border-red-500 p-6 rounded-2xl">
                    <p class="text-3xl font-bold">Kalan < B√∂len</p>
                    <p class="mt-2 text-gray-300">Kalan sayƒ± her zaman b√∂lenden k√º√ß√ºk olmalƒ±dƒ±r!</p>
                </div>
            </div>

            <div id="slide-4" class="slide-content flex-col items-center">
                <h2 class="text-4xl font-bold text-white mb-6">G√∂reve Hazƒ±r Mƒ±sƒ±n?</h2>
                <p class="text-lg text-gray-300 mb-6">ƒ∞≈ülemleri yapmak i√ßin yandaki <strong>√áizim Tahtasƒ±nƒ±</strong> kullanabilirsin!</p>
                <button onclick="startGame()" class="btn-3d px-12 py-4 rounded-xl bg-green-600 text-white font-bold text-2xl">BA≈ûLA üöÄ</button>
            </div>

            <div class="absolute bottom-6 left-0 w-full px-8 flex justify-between">
                <button onclick="prevSlide()" class="p-3 rounded-full bg-white/10 hover:bg-white/20">‚¨ÖÔ∏è Geri</button>
                <button id="next-btn" onclick="nextSlide()" class="p-3 rounded-full bg-white/10 hover:bg-white/20">ƒ∞leri ‚û°Ô∏è</button>
            </div>
        </div>
    </div>

    <!-- OYUN ALANI -->
    <div id="screen-game" class="hidden flex-1 p-2 md:p-4 overflow-hidden relative">
        <div class="game-layout">
            
            <!-- SOL PANEL -->
            <div class="game-panel">
                <div class="flex justify-between items-center mb-2 glass p-2 rounded-xl">
                    <div class="flex items-center gap-4">
                        <div class="text-yellow-400 font-bold text-lg md:text-xl">PUAN: <span id="score">0</span></div>
                        <div class="text-blue-300 font-bold text-sm">SEVƒ∞YE: <span id="level">1</span></div>
                    </div>
                    <div class="flex text-red-500 text-xl" id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
                </div>

                <div class="flex-1 glass rounded-2xl flex flex-col items-center justify-center relative bg-gradient-to-b from-slate-800/80 to-slate-900/80 mb-2">
                    <div id="game-message" class="absolute top-2 text-green-400 text-xs md:text-sm font-bold tracking-widest uppercase">B√ñL√úM√ú BUL</div>

                    <div class="tr-division transform scale-125 md:scale-150 mb-6">
                        <div id="g-dividend" class="tr-left tr-dividend">?</div>
                        <div class="tr-right">
                            <div id="g-divisor" class="tr-divisor">?</div>
                            <div id="g-quotient" class="tr-quotient min-w-[50px] min-h-[40px] border-2 border-dashed border-white/30 rounded flex items-center justify-center text-white bg-white/5">?</div>
                        </div>
                    </div>

                    <div id="remainder-area" class="flex items-center gap-2 opacity-50 transition-all duration-300">
                        <span class="text-lg text-gray-400">Kalan:</span>
                        <div id="g-remainder" class="w-12 h-10 border-2 border-dashed border-red-500/30 rounded flex items-center justify-center text-red-400 font-bold text-xl bg-black/20">?</div>
                    </div>

                    <div id="feedback" class="absolute bottom-4 text-xl font-bold h-6"></div>
                    
                    <button onclick="toggleBoard()" class="lg:hidden absolute top-2 right-2 bg-white/20 hover:bg-white/30 p-2 rounded-lg text-sm flex items-center gap-1">
                        ‚úèÔ∏è ƒ∞≈ülem Yap
                    </button>
                </div>

                <!-- Numpad -->
                <div class="h-auto max-w-sm mx-auto w-full">
                    <div class="grid grid-cols-3 gap-2">
                        <button onclick="inputNum(1)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">1</button>
                        <button onclick="inputNum(2)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">2</button>
                        <button onclick="inputNum(3)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">3</button>
                        <button onclick="inputNum(4)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">4</button>
                        <button onclick="inputNum(5)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">5</button>
                        <button onclick="inputNum(6)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">6</button>
                        <button onclick="inputNum(7)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">7</button>
                        <button onclick="inputNum(8)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">8</button>
                        <button onclick="inputNum(9)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">9</button>
                        <button onclick="clearInput()" class="btn-3d bg-red-600/80 p-3 text-lg font-bold rounded-lg border-b-4 border-red-800">Sƒ∞L</button>
                        <button onclick="inputNum(0)" class="btn-3d glass p-3 text-2xl font-bold rounded-lg">0</button>
                        <button onclick="submitAnswer()" class="btn-3d bg-green-600 p-3 text-lg font-bold rounded-lg border-b-4 border-green-800">OK</button>
                    </div>
                </div>
            </div>

            <!-- SAƒû PANEL: √áizim Tahtasƒ± -->
            <div id="board-panel" class="board-panel">
                <div class="flex justify-between items-center mb-2 bg-black/40 p-2 rounded-lg">
                    <span class="font-bold text-gray-300">üìù ƒ∞≈ülem Alanƒ±</span>
                    <div class="flex gap-2">
                        <button id="tool-pen" onclick="setTool('pen')" class="tool-active p-2 rounded bg-gray-700 hover:bg-gray-600 transition">‚úèÔ∏è</button>
                        <button id="tool-eraser" onclick="setTool('eraser')" class="p-2 rounded bg-gray-700 hover:bg-gray-600 transition">üßº</button>
                        <button onclick="clearCanvas()" class="p-2 rounded bg-red-900/50 hover:bg-red-900 transition text-xs font-bold">TEMƒ∞ZLE</button>
                        <button onclick="toggleBoard()" class="lg:hidden p-2 rounded bg-gray-800 text-white font-bold ml-2">‚ùå</button>
                    </div>
                </div>
                <div class="flex-1 relative w-full h-full bg-gray-800/20 rounded-lg overflow-hidden cursor-crosshair" id="canvas-container">
                    <canvas id="drawing-board" class="w-full h-full block"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- SONU√á EKRANI -->
    <div id="screen-end" class="hidden absolute top-0 left-0 w-full h-full bg-black/95 z-50 flex items-center justify-center p-4">
        <div class="glass p-8 rounded-3xl text-center max-w-md w-full border border-white/20">
            <h2 id="end-title" class="text-4xl font-bold mb-2">Oyun Bitti</h2>
            <div class="text-8xl my-6">üõ∏</div>
            <div class="text-gray-400 mb-2">TOPLAM PUAN</div>
            <div id="final-score" class="text-6xl font-bold text-yellow-400 mb-8">0</div>
            <button onclick="location.reload()" class="btn-3d w-full bg-purple-600 py-4 rounded-xl text-xl font-bold">Ana Men√ºye D√∂n</button>
        </div>
    </div>

    <canvas id="confetti" class="fixed top-0 left-0 pointer-events-none z-50"></canvas>

    <script>
        // Ses
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTone(freq, type, duration) {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // Deƒüi≈ükenler
        let currentSlide = 1;
        const totalSlides = 4;
        let score = 0, lives = 3, level = 1;
        let qDividend = 0, qDivisor = 0, qQuotient = 0, qRemainder = 0;
        let inputBuffer = "", inputPhase = "quotient";
        
        // SORU GE√áMƒ∞≈ûƒ∞ (Unique Question Logic)
        let questionHistory = []; 

        // Canvas
        const canvas = document.getElementById('drawing-board');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let currentTool = 'pen'; 

        function resizeCanvas() {
            const container = document.getElementById('canvas-container');
            if(container) {
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                setContextStyles();
            }
        }
        window.addEventListener('resize', resizeCanvas);

        function setContextStyles() {
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            if (currentTool === 'pen') {
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 3;
                ctx.globalCompositeOperation = 'source-over';
            } else {
                ctx.lineWidth = 20;
                ctx.globalCompositeOperation = 'destination-out';
            }
        }

        function setTool(tool) {
            currentTool = tool;
            document.getElementById('tool-pen').classList.toggle('tool-active', tool === 'pen');
            document.getElementById('tool-eraser').classList.toggle('tool-active', tool === 'eraser');
            setContextStyles();
        }

        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

        function toggleBoard() {
            const board = document.getElementById('board-panel');
            board.classList.toggle('show');
            if(board.classList.contains('show')) setTimeout(resizeCanvas, 50);
        }

        // Draw Events
        canvas.addEventListener('mousedown', startPosition);
        canvas.addEventListener('mouseup', finishedPosition);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseleave', finishedPosition);
        canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startPosition(e.touches[0]); }, {passive: false});
        canvas.addEventListener('touchend', finishedPosition);
        canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e.touches[0]); }, {passive: false});

        function getMousePos(evt) {
            const rect = canvas.getBoundingClientRect();
            return { x: evt.clientX - rect.left, y: evt.clientY - rect.top };
        }
        function startPosition(e) { isDrawing = true; draw(e); }
        function finishedPosition() { isDrawing = false; ctx.beginPath(); }
        function draw(e) {
            if (!isDrawing) return;
            const pos = getMousePos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        // App Logic
        function toggleFullScreen() {
            if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(e=>{});
            else if(document.exitFullscreen) document.exitFullscreen();
        }

        function startTutorial() {
            document.getElementById('screen-menu').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.remove('hidden');
            document.getElementById('screen-tutorial').classList.add('flex');
            changeSlide(1);
        }

        function startGame() {
            document.getElementById('screen-menu').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.add('hidden');
            document.getElementById('screen-tutorial').classList.remove('flex');
            document.getElementById('screen-game').classList.remove('hidden');
            document.getElementById('screen-game').classList.add('flex');
            setTimeout(resizeCanvas, 100);
            setTool('pen');
            score = 0; lives = 3; level = 1; questionHistory = [];
            updateUI();
            generateQuestion();
        }

        function changeSlide(n) {
            currentSlide = n;
            document.querySelectorAll('.slide-content').forEach(s => s.classList.remove('active'));
            document.getElementById(`slide-${n}`).classList.add('active');
            document.getElementById('progress-bar').style.width = `${(n/totalSlides)*100}%`;
            document.getElementById('next-btn').style.display = n === totalSlides ? 'none' : 'block';
        }
        function nextSlide() { if(currentSlide < totalSlides) changeSlide(currentSlide + 1); }
        function prevSlide() { if(currentSlide > 1) changeSlide(currentSlide - 1); else location.reload(); }

        // --- GELƒ∞≈ûMƒ∞≈û SORU √úRETME (BENZERSƒ∞Z) ---
        function generateQuestion() {
            inputBuffer = "";
            inputPhase = "quotient";
            
            // UI Reset
            document.getElementById('g-quotient').textContent = "?";
            document.getElementById('g-quotient').className = "tr-quotient min-w-[50px] min-h-[40px] border-2 border-dashed border-white rounded flex items-center justify-center text-white bg-white/10 pulse-anim";
            document.getElementById('g-remainder').textContent = "?";
            document.getElementById('remainder-area').classList.add('opacity-50');
            document.getElementById('remainder-area').classList.remove('opacity-100');
            document.getElementById('g-remainder').classList.remove('pulse-anim', 'border-white', 'text-white');
            document.getElementById('g-remainder').classList.add('border-red-500/30', 'text-red-400');
            document.getElementById('game-message').textContent = "B√ñL√úM√ú BUL";
            document.getElementById('game-message').className = "absolute top-2 text-green-400 text-xs md:text-sm font-bold tracking-widest uppercase";
            document.getElementById('feedback').textContent = "";

            let attempts = 0;
            let isUnique = false;
            let tempDivisor, tempQuotient, tempRemainder, tempDividend, questionKey;

            // Benzersiz Soru Bulma D√∂ng√ºs√º
            do {
                attempts++;
                let minDiv, maxDiv, minQuot, maxQuot;
                
                // Geni≈ületilmi≈ü Aralƒ±klar
                if (level === 1) { minDiv=2; maxDiv=7; minQuot=2; maxQuot=9; } 
                else if (level === 2) { minDiv=4; maxDiv=12; minQuot=4; maxQuot=12; }
                else { minDiv=6; maxDiv=15; minQuot=5; maxQuot=20; }

                tempDivisor = Math.floor(Math.random() * (maxDiv - minDiv + 1)) + minDiv;
                tempQuotient = Math.floor(Math.random() * (maxQuot - minQuot + 1)) + minQuot;
                
                const isRemainder = Math.random() < 0.5; 
                tempRemainder = isRemainder ? Math.floor(Math.random() * (tempDivisor - 1)) + 1 : 0;
                tempDividend = (tempDivisor * tempQuotient) + tempRemainder;
                
                // Soru Anahtarƒ±: "B√∂l√ºnen-B√∂len" (√ñrn: "13-4")
                questionKey = `${tempDividend}-${tempDivisor}`;

                // Ge√ßmi≈üte var mƒ±?
                if (!questionHistory.includes(questionKey)) {
                    isUnique = true;
                }

                // Sonsuz d√∂ng√º korumasƒ± (eƒüer havuz dolarsa)
                if(attempts > 50) isUnique = true;

            } while (!isUnique);

            // Ge√ßmi≈üe Ekle
            questionHistory.push(questionKey);
            if (questionHistory.length > 15) questionHistory.shift(); // Son 15 soruyu tut

            // Deƒüerleri Ata
            qDivisor = tempDivisor;
            qQuotient = tempQuotient;
            qRemainder = tempRemainder;
            qDividend = tempDividend;

            document.getElementById('g-dividend').textContent = qDividend;
            document.getElementById('g-divisor').textContent = qDivisor;
        }

        function inputNum(n) {
            playTone(400, 'sine', 0.05);
            if (inputBuffer.length < 3) {
                inputBuffer += n;
                updateInputDisplay();
            }
        }

        function clearInput() {
            playTone(200, 'triangle', 0.1);
            inputBuffer = "";
            updateInputDisplay();
        }

        function updateInputDisplay() {
            if (inputPhase === "quotient") document.getElementById('g-quotient').textContent = inputBuffer;
            else document.getElementById('g-remainder').textContent = inputBuffer;
        }

        function submitAnswer() {
            if(inputBuffer === "") return;
            const val = parseInt(inputBuffer);

            if (inputPhase === "quotient") {
                if (val === qQuotient) {
                    playTone(600, 'sine', 0.1); setTimeout(()=>playTone(800,'sine',0.1),100);
                    document.getElementById('g-quotient').className = "tr-quotient font-bold text-green-400 text-4xl";
                    
                    inputPhase = "remainder";
                    inputBuffer = "";
                    document.getElementById('game-message').textContent = "KALANI YAZ";
                    document.getElementById('game-message').className = "absolute top-2 text-red-400 text-xs md:text-sm font-bold tracking-widest animate-pulse";
                    document.getElementById('remainder-area').classList.remove('opacity-50');
                    document.getElementById('remainder-area').classList.add('opacity-100');
                    
                    const remBox = document.getElementById('g-remainder');
                    remBox.classList.remove('border-red-500/30', 'text-red-400');
                    remBox.classList.add('border-white', 'text-white', 'pulse-anim');
                    remBox.textContent = "?";
                } else { wrongAnswer(); }
            } else {
                if (val === qRemainder) {
                    playTone(600, 'square', 0.1); playTone(1000, 'square', 0.2);
                    document.getElementById('g-remainder').classList.remove('pulse-anim');
                    document.getElementById('g-remainder').classList.add('text-green-400', 'border-green-400');
                    
                    score += 10 + (level * 2);
                    document.getElementById('feedback').textContent = "HARƒ∞KA! üåü";
                    document.getElementById('feedback').className = "absolute bottom-4 text-xl font-bold h-6 text-green-400";
                    if(score % 50 === 0) level++;
                    updateUI();
                    startConfettiShort();
                    setTimeout(generateQuestion, 1500);
                } else { wrongAnswer(); }
            }
        }

        function wrongAnswer() {
            playTone(150, 'sawtooth', 0.3);
            lives--;
            updateUI();
            const el = inputPhase === "quotient" ? document.getElementById('g-quotient') : document.getElementById('g-remainder');
            el.style.borderColor = "red";
            el.style.color = "red";
            setTimeout(() => {
                el.style.borderColor = ""; 
                el.style.color = ""; 
                inputBuffer = "";
                updateInputDisplay();
            }, 500);
            if (lives <= 0) {
                document.getElementById('screen-game').classList.add('hidden');
                document.getElementById('screen-end').classList.remove('hidden');
                document.getElementById('final-score').textContent = score;
            }
        }

        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            let hearts = ""; for(let i=0; i<lives; i++) hearts += "‚ù§Ô∏è";
            document.getElementById('lives').textContent = hearts;
        }

        function startConfettiShort() {
            const canvasC = document.getElementById('confetti');
            const ctxC = canvasC.getContext('2d');
            canvasC.width = window.innerWidth;
            canvasC.height = window.innerHeight;
            let particles = [];
            for(let i=0; i<50; i++) {
                particles.push({x:Math.random()*canvasC.width, y:Math.random()*canvasC.height-canvasC.height, vy:Math.random()*5+2, color:`hsl(${Math.random()*360},100%,50%)`});
            }
            let frame = 0;
            function animate() {
                ctxC.clearRect(0,0,canvasC.width,canvasC.height);
                particles.forEach(p => { p.y+=p.vy; ctxC.fillStyle=p.color; ctxC.fillRect(p.x,p.y,6,6); });
                frame++;
                if(frame < 100) requestAnimationFrame(animate);
                else ctxC.clearRect(0,0,canvasC.width,canvasC.height);
            }
            animate();
        }
    </script>
</body>
</html>

