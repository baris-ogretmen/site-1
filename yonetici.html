<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YÃ¶netici Paneli | BarÄ±ÅŸ Ä°lkan</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-config.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f1f5f9; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #2563eb; margin-bottom: 20px; }
        
        .stat-card { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 25px; box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3); }
        .stat-count { font-size: 3.5rem; font-weight: 800; line-height: 1; margin: 10px 0; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #475569; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; font-family: inherit; }
        button { width: 100%; padding: 12px; background: #2563eb; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; transition: 0.3s; }
        
        .item-card { background: #fff; border: 1px solid #e2e8f0; padding: 10px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .item-info { font-size: 0.9rem; font-weight: 600; color: #333; }
        .btn-del-mini { background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; width: auto; }

        .tab-buttons { display: flex; gap: 5px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab-btn { flex: 1; background: #e2e8f0; color: #333; border: none; padding: 10px 5px; cursor: pointer; border-radius: 8px; font-weight: 600; font-size:0.85rem; }
        .tab-btn.active { background: #2563eb; color: white; }

        .message { margin-top: 15px; padding: 15px; border-radius: 8px; display: none; text-align: center; font-weight: bold; }
        .success { background: #dcfce7; color: #166534; } .error { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>

    <div class="container">
        <div class="stat-card">
            <div><i class="fas fa-users"></i> BugÃ¼n Gelen ZiyaretÃ§i</div>
            <div class="stat-count" id="ziyaret-sayisi">0</div>
        </div>

        <h2><i class="fas fa-user-cog"></i> YÃ¶netici Paneli</h2>
        
        <div class="tab-buttons">
            <button class="tab-btn active" id="btn-proje" onclick="tabDegis('proje')">Projeler</button>
            <button class="tab-btn" id="btn-yazi" onclick="tabDegis('yazi')">KÃ¶ÅŸe YazÄ±sÄ±</button>
            <button class="tab-btn" id="btn-duyuru" onclick="tabDegis('duyuru')">Duyurular</button>
            <button class="tab-btn" id="btn-mesaj" onclick="tabDegis('mesaj')" style="background: #FFD700; color: #000;">Mesajlar</button>
        </div>

        <div id="proje-formu">
            <h3 style="color:#475569; margin-top:0;">Yeni Proje Ekle</h3>
            <div class="form-group"><input type="text" id="p-baslik" placeholder="BaÅŸlÄ±k (Ã–rn: AnlÄ±k Bellek)"></div>
            <div class="form-group"><textarea id="p-aciklama" rows="2" placeholder="AÃ§Ä±klama..."></textarea></div>
            <div class="form-group"><input type="text" id="p-link" placeholder="Link (Ã–rn: beyazit.html)"></div>
            <div class="form-group"><select id="p-icon"><option value="fa-brain">ðŸ§  Zeka</option><option value="fa-gamepad">ðŸŽ® Oyun</option><option value="fa-chess-knight">â™ž SatranÃ§</option><option value="fa-robot">ðŸ¤– Robotik</option></select></div>
            <button onclick="projeEkle()">Kaydet</button>
            <div style="margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 10px;"><h4 style="margin:0 0 10px;">ðŸ“‚ Mevcut Projeler</h4><div id="list-projeler"></div></div>
        </div>

        <div id="yazi-formu" style="display:none;">
            <h3 style="color:#475569; margin-top:0;">Ebeveyn KaynaÄŸÄ± Ekle</h3>
            <div class="form-group">
                <label>YazÄ± BaÅŸlÄ±ÄŸÄ±</label>
                <input type="text" id="y-baslik" placeholder="Ã–rn: Kur'an'dan Ã–nce Uyku AhlakÄ±">
            </div>
            <div class="form-group">
                <label>YazÄ± Ä°Ã§eriÄŸi (HTML Kullanabilirsin)</label>
                <textarea id="y-icerik" rows="10" placeholder="YazÄ±nÄ±zÄ± buraya yapÄ±ÅŸtÄ±rÄ±n..."></textarea>
            </div>
            <button onclick="yaziEkle()">YazÄ±yÄ± YayÄ±nla</button>
            <div style="margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 10px;"><h4 style="margin:0 0 10px;">ðŸ“„ Mevcut YazÄ±lar</h4><div id="list-yazilar"></div></div>
        </div>

        <div id="duyuru-formu" style="display:none;">
            <h3 style="color:#475569; margin-top:0;">Duyuru Ekle</h3>
            <div class="form-group"><input type="text" id="d-metin" placeholder="Duyuru metni..."></div>
            <button onclick="duyuruEkle()">Kaydet</button>
            <div style="margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 10px;"><h4 style="margin:0 0 10px;">ðŸ“¢ Duyurular</h4><div id="list-duyurular"></div></div>
        </div>

        <div id="mesaj-formu" style="display:none;">
            <h3 style="color:#475569; margin-top:0;">Gelen Talepler</h3>
            <div id="mesaj-listesi"></div>
        </div>

        <div id="mesaj-kutusu" class="message"></div>
    </div>

    <script>
        const db = firebase.firestore();

        // Ä°statistik
        const bugunStr = new Date().toISOString().split('T')[0];
        db.collection("istatistik").doc(bugunStr).onSnapshot(doc => { document.getElementById('ziyaret-sayisi').innerText = doc.exists ? doc.data().ziyaret : 0; });

        // SEKME GEÃ‡Ä°ÅžLERÄ°
        function tabDegis(tip) {
            document.querySelectorAll('[id$="-formu"]').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tip + '-formu').style.display = 'block';
            if(tip !== 'mesaj') document.getElementById('btn-' + tip).classList.add('active');
        }

        // --- EKLEME FONKSÄ°YONLARI ---
        function projeEkle() {
            const b = document.getElementById('p-baslik').value; const l = document.getElementById('p-link').value; if(!b || !l) return;
            db.collection("projeler").add({ baslik: b, aciklama: document.getElementById('p-aciklama').value, link: l, icon: document.getElementById('p-icon').value, tarih: firebase.firestore.FieldValue.serverTimestamp() }).then(() => { resetForm('proje-formu'); });
        }
        function duyuruEkle() {
            const m = document.getElementById('d-metin').value; if(!m) return;
            db.collection("duyurular").add({ metin: m, tarih: firebase.firestore.FieldValue.serverTimestamp() }).then(() => { resetForm('duyuru-formu'); });
        }
        function yaziEkle() {
            const b = document.getElementById('y-baslik').value; const i = document.getElementById('y-icerik').value; if(!b || !i) return;
            db.collection("yazilar").add({ baslik: b, icerik: i, tarih: firebase.firestore.FieldValue.serverTimestamp() }).then(() => { resetForm('yazi-formu'); });
        }

        // --- LÄ°STELEME ---
        function listeGetir(koleksiyon, divId, ikon) {
            db.collection(koleksiyon).orderBy("tarih", "desc").onSnapshot(snap => {
                let html = "";
                snap.forEach(doc => {
                    const d = doc.data();
                    let baslik = d.baslik || d.metin || d.ad_soyad;
                    html += `<div class="item-card"><div class="item-info">${ikon} ${baslik}</div><button onclick="kayitSil('${koleksiyon}', '${doc.id}')" class="btn-del-mini">Sil</button></div>`;
                });
                document.getElementById(divId).innerHTML = html || "Veri yok.";
            });
        }

        listeGetir("projeler", "list-projeler", "ðŸŽ®");
        listeGetir("yazilar", "list-yazilar", "ðŸ“");
        listeGetir("duyurular", "list-duyurular", "ðŸ“¢");

        // Mesajlar Ã–zel
        db.collection("iletisim_talepleri").orderBy("tarih", "desc").onSnapshot(snap => {
            let html = "";
            snap.forEach(doc => {
                const v = doc.data();
                html += `<div class="item-card" style="display:block; border-left:5px solid #FFD700;"><div style="font-weight:bold; margin-bottom:5px;">${v.ad_soyad}</div><div style="font-size:0.85rem; background:#f9f9f9; padding:5px;">${v.konu}</div><div style="margin-top:10px; display:flex; gap:10px;"><a href="https://wa.me/90${v.telefon.replace(/\D/g,'')}?text=Merhaba ${v.ad_soyad}" target="_blank" style="flex:1; background:#25D366; color:white; text-align:center; padding:5px; border-radius:4px; text-decoration:none;">WhatsApp</a><button onclick="kayitSil('iletisim_talepleri', '${doc.id}')" class="btn-del-mini" style="flex:0.5;">Sil</button></div></div>`;
            });
            document.getElementById('mesaj-listesi').innerHTML = html || "Mesaj yok.";
        });

        function kayitSil(col, id) { if(confirm("Silmek istiyor musun?")) db.collection(col).doc(id).delete().then(()=> gosterMesaj("Silindi", "success")); }
        function resetForm(id) { document.querySelectorAll('#'+id+' input, #'+id+' textarea').forEach(i=>i.value=""); gosterMesaj("BaÅŸarÄ±yla Kaydedildi!", "success"); }
        function gosterMesaj(m, t) { const k = document.getElementById('mesaj-kutusu'); k.innerText=m; k.className="message "+t; k.style.display="block"; setTimeout(()=>k.style.display="none", 3000); }
    </script>
</body>
</html>
