<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dondurma Adasƒ± | Barƒ±≈ü Hoca</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root { --sky: #bae6fd; --sand: #fde68a; --cone: #d97706; --text: #0c4a6e; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; 
            font-family: 'Fredoka', sans-serif; 
            background: linear-gradient(180deg, var(--sky) 0%, #7dd3fc 60%, var(--sand) 60%, var(--sand) 100%);
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden;
            color: var(--text);
        }
        
        /* HEADER */
        header { 
            padding: 10px 15px; 
            display: flex; justify-content: space-between; align-items: center; 
            position: absolute; top: 0; width: 100%; z-index: 50;
        }
        .back-btn { 
            background: white; color: var(--text); width: 45px; height: 45px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            text-decoration: none; font-size: 1.2rem; box-shadow: 0 4px 0 rgba(0,0,0,0.1); cursor: pointer;
        }
        .back-btn:active { transform: translateY(2px); box-shadow: none; }
        .score-board { background: white; padding: 5px 20px; border-radius: 20px; font-weight: bold; font-size: 1.2rem; box-shadow: 0 4px 0 rgba(0,0,0,0.1); }

        /* OYUN ALANI */
        .game-area { 
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            padding-top: 40px; position: relative; width: 100%; max-width: 600px; margin: 0 auto;
        }

        /* DONDURMA KULELERƒ∞ */
        .cones-wrapper {
            display: flex; gap: 20px; align-items: flex-end; margin-bottom: 10px; height: 320px;
            width: 100%; justify-content: center;
        }

        .cone-container {
            display: flex; flex-direction: column-reverse; align-items: center;
            width: 100px; position: relative;
        }

        .cone-label {
            position: absolute; top: -30px; font-weight: bold; 
            background: rgba(255,255,255,0.9); padding: 4px 12px; border-radius: 12px; font-size: 0.8rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); white-space: nowrap;
        }

        /* K√úLAH */
        .cone-base {
            width: 0; height: 0; 
            border-left: 25px solid transparent; border-right: 25px solid transparent; 
            border-top: 80px solid var(--cone);
            position: relative; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
        }
        .cone-base::after {
            content: ''; position: absolute; top: -80px; left: -25px; width: 50px; height: 80px;
            background: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(0,0,0,0.1) 5px, rgba(0,0,0,0.1) 6px);
        }

        /* DONDURMA TOPU */
        .scoop {
            width: 60px; height: 50px; border-radius: 50% 50% 15% 15%;
            margin-bottom: -12px; z-index: 10; position: relative;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: popIn 0.3s;
            border: 2px solid rgba(0,0,0,0.05);
        }
        .scoop::before { 
            content: ''; position: absolute; top: 8px; left: 8px; 
            width: 12px; height: 8px; background: rgba(255,255,255,0.3); border-radius: 50%;
        }

        /* TEZGAH (BUTONLAR) */
        .flavors-panel {
            background: white; width: 100%; padding: 15px; 
            border-radius: 30px 30px 0 0; z-index: 20;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            display: flex; flex-direction: column; align-items: center;
            max-height: 40vh; /* √áok yer kaplamasƒ±n */
        }
        .flavors-grid {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; width: 100%;
            overflow-y: auto; padding-bottom: 10px;
        }
        
        /* K√º√ß√ºk ekranlarda 4'l√º olsun sƒ±ƒüsƒ±n */
        @media (max-width: 380px) {
            .flavors-grid { grid-template-columns: repeat(4, 1fr); }
        }

        .flavor-btn {
            aspect-ratio: 1; border: none; border-radius: 15px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; font-family: 'Fredoka', sans-serif; font-size: 0.7rem; 
            color: #444; cursor: pointer; transition: 0.1s; box-shadow: 0 3px 0 rgba(0,0,0,0.2);
            background: #f8fafc; border: 1px solid #e2e8f0;
        }
        .flavor-btn:active { transform: translateY(3px); box-shadow: none; }
        .flavor-circle { width: 30px; height: 30px; border-radius: 50%; margin-bottom: 4px; border: 1px solid rgba(0,0,0,0.1); }

        .controls { display: flex; gap: 10px; width: 100%; margin-top: auto; padding-top: 10px; border-top: 1px solid #eee; }
        .ctrl-btn { flex: 1; padding: 12px; border: none; border-radius: 12px; font-weight: bold; font-size: 1rem; cursor: pointer; color: white; transition: 0.2s; }
        .btn-undo { background: #ef4444; box-shadow: 0 4px 0 #b91c1c; }
        .btn-check { background: #22c55e; box-shadow: 0 4px 0 #15803d; }
        .ctrl-btn:active { transform: translateY(4px); box-shadow: none; }

        /* BA≈ûLANGI√á EKRANI */
        #start-screen {
            position: fixed; inset: 0; background: linear-gradient(135deg, #bae6fd, #fde68a);
            z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;
        }
        .start-card {
            background: white; padding: 30px; border-radius: 30px; width: 90%; max-width: 350px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2); animation: popIn 0.5s;
        }
        .play-btn {
            background: #d97706; color: white; border: none; padding: 15px 40px; 
            font-size: 1.5rem; border-radius: 50px; font-weight: bold; cursor: pointer; 
            box-shadow: 0 6px 0 #92400e; margin-top: 20px; transition: 0.2s;
        }
        .play-btn:active { transform: translateY(6px); box-shadow: none; }

        /* ANƒ∞MASYONLAR */
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
        .shake { animation: shake 0.4s; }
        @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-5px)} 75%{transform:translateX(5px)} }

    </style>
</head>
<body>

    <header>
        <a href="index.html" class="back-btn"><i class="fa-solid fa-house"></i></a>
        <div class="score-board">Skor: <span id="score">0</span></div>
    </header>

    <div class="game-area">
        
        <div class="cones-wrapper">
            <div class="cone-container">
                <div class="cone-label" style="color: #d97706;">M√ú≈ûTERƒ∞</div>
                <div id="target-scoops"></div>
                <div class="cone-base"></div>
            </div>

            <div class="cone-container" id="player-cone">
                <div class="cone-label" style="color: #0c4a6e;">SENƒ∞N K√úLAHIN</div>
                <div id="player-scoops"></div>
                <div class="cone-base"></div>
            </div>
        </div>

    </div>

    <div class="flavors-panel">
        <div class="flavors-grid" id="flavors-grid">
            </div>
        <div class="controls">
            <button class="ctrl-btn btn-undo" onclick="game.undo()"><i class="fa-solid fa-rotate-left"></i> Sƒ∞L</button>
            <button class="ctrl-btn btn-check" onclick="game.check()"><i class="fa-solid fa-bell-concierge"></i> TESLƒ∞M ET</button>
        </div>
    </div>

    <div id="start-screen">
        <div class="start-card">
            <h1 style="font-size: 2.5rem; margin: 0; color: #0c4a6e;">DONDURMA<br><span style="color: #f43f5e;">ADASI</span></h1>
            <div style="font-size: 4rem; margin: 10px;">üèùÔ∏èüç¶</div>
            <p style="color: #666; font-size: 1rem;">M√º≈üterinin istediƒüi dondurmayƒ± sƒ±rasƒ±yla yap!</p>
            <button class="play-btn" onclick="game.start()">D√úKKANI A√á</button>
        </div>
    </div>

    <script>
        // DONDURMA √áE≈ûƒ∞TLERƒ∞ (TEK KAYNAK)
        const flavors = [
            { id: 'vanilla', name: 'Vanilya', color: '#fef3c7' },
            { id: 'chocolate', name: '√áikolata', color: '#5d4037' },
            { id: 'strawberry', name: '√áilek', color: '#f43f5e' },
            { id: 'mint', name: 'Nane', color: '#86efac' },
            { id: 'lemon', name: 'Limon', color: '#fde047' },
            { id: 'blueberry', name: 'Yaban M.', color: '#3b82f6' },
            { id: 'cherry', name: 'Vi≈üne', color: '#be123c' },
            { id: 'gum', name: 'Sakƒ±z', color: '#d8b4fe' },
            { id: 'caramel', name: 'Karamel', color: '#d97706' },
            { id: 'blackberry', name: 'B√∂ƒü√ºrtlen', color: '#4c1d95' }
        ];

        const game = {
            targetStack: [],
            playerStack: [],
            score: 0,
            level: 1,

            start: function() {
                document.getElementById('start-screen').style.display = 'none';
                this.score = 0;
                this.level = 1;
                this.updateScore();
                this.renderButtons(); // Butonlarƒ± olu≈ütur
                this.newRound();
            },

            // Tezgah butonlarƒ±nƒ± dinamik olu≈ütur (Hata olmamasƒ± i√ßin)
            renderButtons: function() {
                const grid = document.getElementById('flavors-grid');
                grid.innerHTML = '';
                
                flavors.forEach(f => {
                    const btn = document.createElement('button');
                    btn.className = 'flavor-btn';
                    btn.onclick = () => this.addScoop(f);
                    btn.innerHTML = `
                        <div class="flavor-circle" style="background-color: ${f.color};"></div>
                        ${f.name}
                    `;
                    grid.appendChild(btn);
                });
            },

            newRound: function() {
                this.targetStack = [];
                this.playerStack = [];
                this.renderStacks();

                // Seviyeye g√∂re top sayƒ±sƒ± (Min 2, Max 5)
                const count = Math.min(2 + Math.floor(this.score / 30), 5);
                
                for(let i=0; i<count; i++) {
                    // Rastgele bir dondurma se√ß
                    const randomFlavor = flavors[Math.floor(Math.random() * flavors.length)];
                    this.targetStack.push(randomFlavor);
                }
                this.renderStacks();
            },

            addScoop: function(flavor) {
                if(this.playerStack.length >= 6) return; // Maksimum y√ºkseklik sƒ±nƒ±rƒ±
                this.playerStack.push(flavor);
                this.renderStacks();
            },

            undo: function() {
                this.playerStack.pop();
                this.renderStacks();
            },

            renderStacks: function() {
                const tDiv = document.getElementById('target-scoops');
                const pDiv = document.getElementById('player-scoops');
                tDiv.innerHTML = '';
                pDiv.innerHTML = '';

                // Hedef Render
                this.targetStack.forEach(f => {
                    const el = document.createElement('div');
                    el.className = 'scoop';
                    el.style.backgroundColor = f.color;
                    tDiv.appendChild(el);
                });

                // Oyuncu Render
                this.playerStack.forEach(f => {
                    const el = document.createElement('div');
                    el.className = 'scoop';
                    el.style.backgroundColor = f.color;
                    pDiv.appendChild(el);
                });
            },

            check: function() {
                if(this.playerStack.length === 0) return;

                // Dizileri kar≈üƒ±la≈ütƒ±r (ID'lerine g√∂re)
                const targetIds = JSON.stringify(this.targetStack.map(f => f.id));
                const playerIds = JSON.stringify(this.playerStack.map(f => f.id));

                if(targetIds === playerIds) {
                    confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
                    this.score += 10;
                    this.updateScore();
                    // Ba≈üarƒ±lƒ± efekti
                    const pCone = document.getElementById('player-cone');
                    pCone.style.transform = "scale(1.2)";
                    setTimeout(() => {
                        pCone.style.transform = "scale(1)";
                        alert("Harika! M√º≈üteri √ßok beƒüendi. üòã");
                        this.newRound();
                    }, 500);
                } else {
                    document.getElementById('player-cone').classList.add('shake');
                    setTimeout(() => document.getElementById('player-cone').classList.remove('shake'), 400);
                    // Hatalƒ± sesi veya titre≈üim eklenebilir
                    if(navigator.vibrate) navigator.vibrate(200);
                }
            },

            updateScore: function() {
                document.getElementById('score').innerText = this.score;
            }
        };
    </script>
</body>
</html>
