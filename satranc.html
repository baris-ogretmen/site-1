<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BarÄ±ÅŸ SatranÃ§ Akademisi | Pro</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="firebase-config.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #f1c40f;
            --light: #ecf0f1;
            --board-dark: #b58863;
            --board-light: #f0d9b5;
        }

        body { margin: 0; font-family: 'Nunito', sans-serif; background: var(--primary); color: var(--light); padding-bottom: 60px; user-select: none; }
        
        /* HEADER */
        header { 
            background: linear-gradient(135deg, #1a252f, #2c3e50); padding: 20px; text-align: center; 
            border-bottom: 5px solid var(--accent); box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .back-btn { 
            position: absolute; left: 20px; top: 25px; color: var(--accent); text-decoration: none; 
            font-weight: bold; border: 2px solid var(--accent); padding: 8px 15px; border-radius: 20px;
        }
        h1 { font-family: 'Cinzel', serif; font-size: 2rem; margin: 0; color: var(--accent); }

        /* TABS */
        .nav-tabs { display: flex; justify-content: center; gap: 10px; background: #34495e; padding: 15px; flex-wrap: wrap; }
        .nav-btn {
            background: rgba(255,255,255,0.1); color: #fff; border: none; padding: 12px 20px; cursor: pointer;
            font-weight: bold; border-radius: 10px; transition: 0.3s; font-size: 0.95rem; display: flex; align-items: center; gap: 8px;
        }
        .nav-btn.active { background: var(--accent); color: var(--primary); }

        .container { max-width: 1100px; margin: 30px auto; padding: 0 15px; }
        .tab-content { display: none; animation: fadeIn 0.5s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

        /* SATRANÃ‡ TAHTASI */
        .game-wrapper { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; }
        #board1, #drillBoard { width: 100%; max-width: 450px; margin: 0 auto; border: 5px solid #444; }
        /* TAÅLARIN GÃ–RÃœNMESÄ° Ä°Ã‡Ä°N KRÄ°TÄ°K CSS */
        .board-b72b1 img { width: 100%; } 

        .game-panel { width: 100%; max-width: 300px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 15px; }
        .status-display { background: #fff; color: #333; padding: 10px; border-radius: 5px; font-weight: bold; text-align: center; margin-bottom: 15px; border-left: 5px solid var(--accent); }
        .btn { width: 100%; padding: 12px; margin-bottom: 10px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn-gold { background: var(--accent); color: var(--primary); }
        .btn-dark { background: #34495e; color: white; }

        /* KARTLAR */
        .lesson-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }
        .lesson-card { background: #fff; color: #333; border-radius: 12px; padding: 15px; text-align: center; cursor: pointer; transition: 0.3s; border-bottom: 4px solid #bdc3c7; }
        .lesson-card:hover { transform: translateY(-5px); border-bottom-color: var(--accent); background: #fffde7; }
        
        .prodigy-card { background: #fff; color: #333; border-radius: 10px; overflow: hidden; margin-bottom: 20px; border-top: 5px solid #e74c3c; }
        .prodigy-head { background: #ecf0f1; padding: 15px; font-weight: bold; }
        .prodigy-body { padding: 15px; font-size: 0.95rem; line-height: 1.5; }

        /* ANTRENMAN MODALI */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10000; align-items: center; justify-content: center; overflow-y: auto; }
        .modal-content { background: #fff; color: #333; padding: 25px; border-radius: 20px; max-width: 500px; width: 90%; text-align: center; position: relative; border: 4px solid var(--accent); margin: 20px; }
        .close-modal { position: absolute; top: 10px; right: 15px; font-size: 2rem; cursor: pointer; color: #e74c3c; }

        /* TAÅLARIN YOLCULUÄU IZGARA */
        .tour-board { display: grid; grid-template-columns: repeat(8, 1fr); width: 100%; max-width: 380px; margin: 0 auto; border: 5px solid #8d6e63; background: #8d6e63; gap: 1px; aspect-ratio: 1; }
        .tour-cell { display: flex; align-items: center; justify-content: center; font-size: 2rem; cursor: pointer; background: #e8d0aa; position: relative; }
        .tour-cell:nth-child(even) { background: #b08664; } 
        /* Renk DÃ¼zeltme */
        .tour-cell:nth-child(16n + 2), .tour-cell:nth-child(16n + 4), .tour-cell:nth-child(16n + 6), .tour-cell:nth-child(16n + 8),
        .tour-cell:nth-child(16n + 9), .tour-cell:nth-child(16n + 11), .tour-cell:nth-child(16n + 13), .tour-cell:nth-child(16n + 15) { background: #b08664; }
        .tour-cell:nth-child(16n + 1), .tour-cell:nth-child(16n + 3), .tour-cell:nth-child(16n + 5), .tour-cell:nth-child(16n + 7),
        .tour-cell:nth-child(16n + 10), .tour-cell:nth-child(16n + 12), .tour-cell:nth-child(16n + 14), .tour-cell:nth-child(16n + 16) { background: #e8d0aa; }
        .star-target::after { content: 'â­'; position: absolute; font-size: 1.5rem; animation: spin 3s infinite linear; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <header>
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i> Ã‡Ä±kÄ±ÅŸ</a>
        <h1>SATRANÃ‡ AKADEMÄ°SÄ°</h1>
        <p style="margin:5px 0 0; color:#bdc3c7;">Hamle SÄ±rasÄ± Sende!</p>
    </header>

    <div class="nav-tabs">
        <button class="nav-btn active" onclick="tabAc('oyna')"><i class="fas fa-chess-board"></i> MAÃ‡ YAP</button>
        <button class="nav-btn" onclick="tabAc('okul')"><i class="fas fa-graduation-cap"></i> AKADEMÄ°K DERS</button>
        <button class="nav-btn" onclick="tabAc('yolculuk')"><i class="fas fa-rocket"></i> YILDIZ TOPLA</button>
        <button class="nav-btn" onclick="tabAc('kultur')"><i class="fas fa-brain"></i> DAHÄ°LER & KÃœLTÃœR</button>
    </div>

    <div class="container">

        <div id="oyna" class="tab-content active">
            <div class="game-wrapper">
                <div id="board1"></div>
                <div class="game-panel">
                    <div class="status-display" id="gameStatus">Oyun Modunu SeÃ§</div>
                    <select id="gameMode" style="width:100%; padding:10px; margin:5px 0 15px; border-radius:5px;">
                        <option value="bot">ğŸ¤– BarÄ±ÅŸBot (Yapay Zeka)</option>
                        <option value="human">ğŸ‘¤ ArkadaÅŸÄ±nla (2 KiÅŸilik)</option>
                    </select>
                    <button class="btn btn-gold" onclick="newGame()">BAÅLAT</button>
                    <button class="btn btn-dark" onclick="undoMove()">GERÄ° AL</button>
                    <button class="btn btn-dark" onclick="board.flip()">TAHTAYI Ã‡EVÄ°R</button>
                </div>
            </div>
        </div>

        <div id="okul" class="tab-content">
            <h2 style="text-align:center; color:var(--accent);">â™Ÿï¸ Temel TaÅŸ Dersleri</h2>
            <div class="lesson-grid">
                <div class="lesson-card" onclick="alert('Piyon: Sadece ileri gider. Ä°lk hamlede 2 kare Ã§Ä±kabilir. Ã‡apraz yer.')"><i class="fas fa-chess-pawn fa-2x"></i><br>Piyon</div>
                <div class="lesson-card" onclick="alert('At: L Ã§izer. TaÅŸlarÄ±n Ã¼stÃ¼nden atlayabilen tek taÅŸtÄ±r.')"><i class="fas fa-chess-knight fa-2x"></i><br>At</div>
                <div class="lesson-card" onclick="alert('Fil: Sadece Ã§apraz gider. Kendi renginden asla Ã§Ä±kamaz.')"><i class="fas fa-chess-bishop fa-2x"></i><br>Fil</div>
                <div class="lesson-card" onclick="alert('Kale: Yatay ve dikey (dÃ¼z) gider. Uzun menzillidir.')"><i class="fas fa-chess-rook fa-2x"></i><br>Kale</div>
                <div class="lesson-card" onclick="alert('Vezir: En gÃ¼Ã§lÃ¼ taÅŸtÄ±r. Hem kale hem fil gibi gider.')"><i class="fas fa-chess-queen fa-2x"></i><br>Vezir</div>
                <div class="lesson-card" onclick="alert('Åah: Sadece 1 kare her yÃ¶ne gider. O dÃ¼ÅŸerse oyun biter.')"><i class="fas fa-chess-king fa-2x"></i><br>Åah</div>
            </div>

            <h2 style="text-align:center; color:var(--accent); margin-top:40px;">ğŸ“ Ä°nteraktif Antrenman</h2>
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:20px;">
                
                <div style="background:#fff; color:#333; padding:20px; border-radius:15px; border-left:5px solid #2ecc71;">
                    <h3>ğŸ° Rok Hamlesi</h3>
                    <p>Rok, ÅŸahÄ± gÃ¼venliÄŸe almanÄ±n en iyi yoludur. Åah ve Kale aynÄ± anda hareket eder. AralarÄ±nda taÅŸ olmamalÄ±dÄ±r.</p>
                    <button class="btn btn-gold" onclick="startDrill('rok')">AntrenmanÄ± BaÅŸlat â–¶</button>
                </div>

                <div style="background:#fff; color:#333; padding:20px; border-radius:15px; border-left:5px solid #e74c3c;">
                    <h3>âš¡ Ã‡oban MatÄ±</h3>
                    <p>Rakibin en zayÄ±f noktasÄ± olan f7 piyonuna saldÄ±rarak 4 hamlede mat etme taktiÄŸidir.</p>
                    <button class="btn btn-gold" onclick="startDrill('coban')">MatÄ± Uygula â–¶</button>
                </div>

            </div>
        </div>

        <div id="yolculuk" class="tab-content">
            <div style="text-align:center;">
                <h2 style="color:var(--accent);">TaÅŸÄ±nÄ± SeÃ§, YÄ±ldÄ±zlarÄ± Topla!</h2>
                <div style="margin-bottom:15px; display:flex; justify-content:center; gap:5px;">
                    <button class="btn btn-dark" style="width:auto; padding:8px 15px;" onclick="setTourPiece('knight')">At</button>
                    <button class="btn btn-dark" style="width:auto; padding:8px 15px;" onclick="setTourPiece('rook')">Kale</button>
                    <button class="btn btn-dark" style="width:auto; padding:8px 15px;" onclick="setTourPiece('bishop')">Fil</button>
                    <button class="btn btn-dark" style="width:auto; padding:8px 15px;" onclick="setTourPiece('queen')">Vezir</button>
                </div>
                <div class="status-display" id="tour-status">TaÅŸ seÃ§ ve baÅŸla!</div>
                <div id="tourBoard" class="tour-board"></div>
            </div>
        </div>

        <div id="kultur" class="tab-content">
            
            <h2 style="text-align:center; color:var(--accent);">ğŸ‡¹ğŸ‡· TÃ¼rk SatranÃ§ Dahileri</h2>
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap:20px;">
                <div class="prodigy-card">
                    <div class="prodigy-head">ğŸ† Ediz GÃ¼rel</div>
                    <div class="prodigy-body">GenÃ§ yaÅŸta "BÃ¼yÃ¼kusta" (GM) unvanÄ± alan gururumuz. TÃ¼rkiye'nin satranÃ§taki yÃ¼kselen yÄ±ldÄ±zÄ±.</div>
                </div>
                <div class="prodigy-card">
                    <div class="prodigy-head">ğŸ† YaÄŸÄ±z Kaan ErdoÄŸmuÅŸ</div>
                    <div class="prodigy-body">DÃ¼nya satranÃ§ tarihine geÃ§en 12 yaÅŸÄ±ndaki dahi Ã§ocuk. DÃ¼nyanÄ±n en genÃ§ GM'lerinden biri.</div>
                </div>
            </div>

            <h2 style="text-align:center; color:var(--accent); margin-top:30px;">ğŸ¥ Animasyon: Geri's Game</h2>
            <div style="background:#000; border:4px solid var(--accent); border-radius:10px; overflow:hidden; max-width:600px; margin:0 auto;">
                <iframe width="100%" height="315" src="https://www.youtube.com/embed/9IYRC7g2ICg" frameborder="0" allowfullscreen></iframe>
            </div>

            <div id="panel-icerik" style="margin-top:30px;"></div>
        </div>

    </div>

    <div id="drillModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('drillModal').style.display='none'">&times;</span>
            <h2 id="drillTitle" style="color:#2c3e50;"></h2>
            <p id="drillDesc" style="color:#666; font-size:0.9rem;"></p>
            <div id="drillBoard" style="width:100%"></div>
            <div id="drillStatus" style="font-weight:bold; margin-top:10px; color:#e67e22;">SÄ±ra Sende!</div>
        </div>
    </div>

    <script>
        // --- 1. OYUN MOTORU (GÃ–RSEL SORUNU KESÄ°N Ã‡Ã–ZÃœM) ---
        // Chessboard.js'in kendi sitesindeki kararlÄ± gÃ¶rsel setini kullanÄ±yoruz.
        function pieceTheme(piece) {
            return 'https://chessboardjs.com/img/chesspieces/wikipedia/' + piece + '.png';
        }

        var board = null;
        var game = new Chess();

        function onDragStart(source, piece) {
            if (game.game_over()) return false;
            if ((game.turn() === 'w' && piece.search(/^b/) !== -1) || (game.turn() === 'b' && piece.search(/^w/) !== -1)) return false;
        }

        function onDrop(source, target) {
            var move = game.move({ from: source, to: target, promotion: 'q' });
            if (move === null) return 'snapback';
            updateStatus();
            if(document.getElementById('gameMode').value === 'bot' && game.turn() === 'b') window.setTimeout(makeRandomMove, 250);
        }

        function onSnapEnd() { board.position(game.fen()); }

        function makeRandomMove() {
            var moves = game.moves();
            if (moves.length === 0) return;
            game.move(moves[Math.floor(Math.random() * moves.length)]);
            board.position(game.fen());
            updateStatus();
        }

        function updateStatus() {
            var status = '';
            var moveColor = (game.turn() === 'b') ? 'Siyah' : 'Beyaz';
            if (game.in_checkmate()) status = 'MAT! Kazanan: ' + (moveColor==='Beyaz'?'Siyah':'Beyaz');
            else if (game.in_draw()) status = 'Berabere!';
            else { status = 'SÄ±ra: ' + moveColor; if (game.in_check()) status += ' (ÅAH!)'; }
            document.getElementById('gameStatus').innerText = status;
        }

        function newGame() { game.reset(); board.start(); updateStatus(); }
        function undoMove() { game.undo(); if(document.getElementById('gameMode').value==='bot') game.undo(); board.position(game.fen()); updateStatus(); }

        var config = { draggable: true, position: 'start', onDragStart: onDragStart, onDrop: onDrop, onSnapEnd: onSnapEnd, pieceTheme: pieceTheme };
        board = Chessboard('board1', config);
        updateStatus();

        // --- 2. ANTRENMAN MODÃœLÃœ ---
        var drillBoard = null; var drillGame = new Chess(); var currentDrill = '';
        function startDrill(type) {
            currentDrill = type;
            document.getElementById('drillModal').style.display = 'flex';
            document.getElementById('drillStatus').innerText = "Yapman gereken hamleyi bul!";
            
            if(type === 'rok') {
                document.getElementById('drillTitle').innerText = "ROK Ã‡ALIÅMASI";
                document.getElementById('drillDesc').innerText = "Beyaz sensin. ÅahÄ± ve kaleyi kullanarak kÄ±sa rok yap.";
                drillGame.load("r3k2r/pppppppp/8/8/8/8/PPPPPPPP/R3K2R w KQkq - 0 1");
            } else if (type === 'coban') {
                document.getElementById('drillTitle').innerText = "Ã‡OBAN MATI";
                document.getElementById('drillDesc').innerText = "Beyaz sensin. Vezir ile f7 piyonunu alarak mat et.";
                drillGame.load("r1bqkb1r/pppp1ppp/2n2n2/4p3/2B1P3/5Q2/PPPP1PPP/RNB1K1NR w KQkq - 4 4");
            }
            
            if(drillBoard) drillBoard.destroy();
            drillBoard = Chessboard('drillBoard', {
                position: drillGame.fen(), draggable: true, pieceTheme: pieceTheme,
                onDragStart: (s, p) => { if(drillGame.turn() === 'b') return false; },
                onDrop: (s, t) => {
                    var m = drillGame.move({ from: s, to: t, promotion: 'q' });
                    if(m === null) return 'snapback';
                    
                    if(currentDrill === 'rok' && (m.san === 'O-O' || m.san === 'O-O-O')) {
                        document.getElementById('drillStatus').innerText = "âœ… BRAVO! Rok yaptÄ±n.";
                    } else if (currentDrill === 'coban' && m.to === 'f7') {
                        document.getElementById('drillStatus').innerText = "âœ… MÃœKEMMEL! Åah Mat.";
                    } else {
                        document.getElementById('drillStatus').innerText = "âŒ YanlÄ±ÅŸ hamle, tekrar dene.";
                        setTimeout(() => { drillGame.undo(); drillBoard.position(drillGame.fen()); }, 800);
                    }
                }
            });
        }

        // --- 3. YILDIZ TOPLAMA (MÄ°NÄ° OYUN) ---
        let tourPiece='knight', playerPos=0, targetPos=0, score=0; const TARGET=5;
        function setTourPiece(p) { tourPiece=p; score=0; initTourGame(); }
        function initTourGame() { playerPos=Math.floor(Math.random()*64); do{targetPos=Math.floor(Math.random()*64);}while(targetPos===playerPos); drawTourBoard(); document.getElementById('tour-status').innerText=`YÄ±ldÄ±z: ${score}/${TARGET}`; }
        function drawTourBoard() {
            const el=document.getElementById('tourBoard'); el.innerHTML=''; const icons={'knight':'knight','rook':'rook','bishop':'bishop','queen':'queen'};
            for(let i=0;i<64;i++){
                const c=document.createElement('div'); c.className='tour-cell';
                if(i===playerPos) c.innerHTML=`<i class="fas fa-chess-${icons[tourPiece]}" style="color:#2c3e50;"></i>`;
                if(i===targetPos) c.classList.add('star-target');
                c.onclick=()=>movePlayer(i); el.appendChild(c);
            }
        }
        function movePlayer(to) {
            const r1=Math.floor(playerPos/8), c1=playerPos%8, r2=Math.floor(to/8), c2=to%8;
            const dr=Math.abs(r1-r2), dc=Math.abs(c1-c2);
            let ok = false;
            if(tourPiece=='rook') ok = r1==r2||c1==c2; else if(tourPiece=='bishop') ok = dr==dc;
            else if(tourPiece=='queen') ok = r1==r2||c1==c2||dr==dc; else if(tourPiece=='knight') ok = dr*dc==2;
            
            if(ok) { playerPos=to; if(playerPos===targetPos){ score++; if(score>=TARGET){alert("TEBRÄ°KLER! ğŸ‰"); score=0;} do{targetPos=Math.floor(Math.random()*64);}while(targetPos===playerPos); } document.getElementById('tour-status').innerText=`YÄ±ldÄ±z: ${score}/${TARGET}`; drawTourBoard(); }
        }

        // --- GENEL ---
        function tabAc(id) {
            document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
            if(id==='yolculuk') initTourGame();
        }

        // PANEL VERÄ°LERÄ°
        const db=firebase.firestore();
        db.collection("projeler").orderBy("tarih","desc").onSnapshot(s=>{
            let h=""; s.forEach(d=>{ const v=d.data(); if((v.kategori||"").toLowerCase().includes("satranÃ§")) h+=`<div style="background:#fff;color:#333;padding:10px;margin-bottom:5px;border-left:4px solid var(--accent);">ğŸ†• ${v.baslik}</div>`; });
            document.getElementById('panel-icerik').innerHTML=h;
        });
    </script>
</body>
</html>
