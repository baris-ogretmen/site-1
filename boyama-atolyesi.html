<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minik Ressamƒ±n At√∂lyesi | Barƒ±≈ü √ñƒüretmen</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.11/html-to-image.min.js"></script>
    
    <style>
        /* SIFIRLAMA VE TEMEL AYARLAR */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; padding: 0;
            font-family: 'Comic Neue', cursive; 
            background: #fffbeb; 
            height: 100vh; width: 100vw;
            display: flex; flex-direction: column;
            overflow: hidden; /* Sayfa kaymasƒ±nƒ± engelle */
            user-select: none;
        }

        /* √úST BAR (HEADER) */
        header { 
            background: #f59e0b; padding: 10px 15px; 
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 20;
            flex-shrink: 0; /* K√º√ß√ºlmesin */
        }
        .back-btn { 
            background: white; color: #d97706; padding: 5px 12px; border-radius: 20px; 
            text-decoration: none; font-weight: bold; font-size: 0.9rem; 
            border: 2px solid #fbbf24;
        }
        h1 { margin: 0; font-size: 1.2rem; color: white; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
        .action-btn {
            background: #3b82f6; color: white; border: none; padding: 8px 15px;
            border-radius: 20px; font-weight: bold; font-family: inherit; font-size: 0.9rem;
            cursor: pointer; margin-left: 5px; box-shadow: 0 3px 0 #1d4ed8;
        }
        .action-btn:active { transform: translateY(2px); box-shadow: none; }
        .btn-green { background: #10b981; box-shadow: 0 3px 0 #047857; }

        /* √áALI≈ûMA ALANI (WORKSPACE) */
        .workspace { 
            flex: 1; display: flex; flex-direction: column; 
            position: relative; overflow: hidden; background: #fff7ed;
        }

        /* RESƒ∞M ALANI (KANVAS) */
        .canvas-container {
            flex: 1; display: flex; align-items: center; justify-content: center;
            padding: 10px; overflow: hidden;
        }
        #svg-canvas {
            width: 100%; height: 100%;
            max-width: 600px; /* PC'de √ßok b√ºy√ºmesin */
            display: flex; align-items: center; justify-content: center;
        }
        svg {
            width: 100%; height: 100%;
            max-height: 80vh; /* Ekrana sƒ±ƒüsƒ±n */
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1));
        }
        /* Boyanabilir alanlar */
        path, circle, rect, polygon, ellipse { cursor: pointer; transition: fill 0.1s; }
        path:hover, circle:hover { opacity: 0.9; }

        /* ALT BAR (RENK PALETƒ∞) */
        .palette-container {
            background: white; padding: 10px;
            border-top: 4px solid #fcd34d;
            display: flex; align-items: center; gap: 10px;
            overflow-x: auto; /* Yanlamasƒ±na kaydƒ±rma */
            flex-shrink: 0;
            white-space: nowrap;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.05);
        }
        /* Kaydƒ±rma √ßubuƒüunu gizle (Mobil estetik) */
        .palette-container::-webkit-scrollbar { display: none; }
        
        .color-swatch {
            width: 45px; height: 45px; border-radius: 50%;
            border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            flex-shrink: 0; cursor: pointer; position: relative;
        }
        .color-swatch.active {
            transform: scale(1.1); border-color: #333;
            box-shadow: 0 0 0 2px #fff, 0 5px 10px rgba(0,0,0,0.3);
        }
        .color-swatch::after {
            content: ''; position: absolute; top:0; left:0; right:0; bottom:0;
            border-radius: 50%; box-shadow: inset 0 -3px 5px rgba(0,0,0,0.2);
        }

        /* GALERƒ∞ MODALI */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100; align-items: center; justify-content: center;
            backdrop-filter: blur(5px);
        }
        .gallery-modal {
            background: #fffbeb; width: 90%; max-width: 800px; height: 85%;
            border-radius: 20px; border: 5px solid #f59e0b;
            display: flex; flex-direction: column; overflow: hidden;
        }
        .gallery-header {
            padding: 15px; background: #fef3c7; border-bottom: 2px solid #fcd34d;
            text-align: center;
        }
        .gallery-header h2 { margin: 0; color: #d97706; }
        
        /* Kategori Butonlarƒ± */
        .category-tabs { display: flex; gap: 10px; justify-content: center; margin-top: 10px; flex-wrap: wrap; }
        .cat-btn {
            background: white; border: 2px solid #f59e0b; color: #d97706;
            padding: 5px 15px; border-radius: 15px; font-weight: bold; cursor: pointer;
        }
        .cat-btn.active { background: #f59e0b; color: white; }

        .gallery-content {
            flex: 1; overflow-y: auto; padding: 20px;
            display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 15px;
        }
        .gallery-item {
            background: white; border: 3px solid #fbbf24; border-radius: 15px;
            padding: 10px; cursor: pointer; transition: 0.2s;
            display: flex; flex-direction: column; align-items: center;
        }
        .gallery-item:active { transform: scale(0.95); }
        .gallery-item svg { height: 80px; width: auto; pointer-events: none; }
        .gallery-item span { font-size: 0.9rem; font-weight: bold; color: #78716c; margin-top: 5px; }

        .close-modal-btn {
            margin: 10px; padding: 12px; background: #ef4444; color: white; border: none;
            border-radius: 10px; font-size: 1rem; font-weight: bold; cursor: pointer;
        }

        /* PC ƒ∞√áƒ∞N EK D√úZENLEMELER */
        @media (min-width: 768px) {
            .workspace { flex-direction: row; }
            .palette-container { 
                flex-direction: column; width: 80px; height: 100%; 
                border-top: none; border-right: 4px solid #fcd34d; overflow-y: auto; 
            }
            .color-swatch { width: 50px; height: 50px; margin-bottom: 10px; }
            .canvas-container { padding: 40px; }
        }
    </style>
</head>
<body>

    <audio id="pop-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-click-1112.mp3"></audio>

    <header>
        <a href="okul-oncesi.html" class="back-btn"><i class="fas fa-chevron-left"></i> √áƒ±kƒ±≈ü</a>
        <h1>üé® At√∂lye</h1>
        <div>
            <button class="action-btn" onclick="openGallery()"><i class="fas fa-images"></i> Se√ß</button>
            <button class="action-btn btn-green" onclick="saveArt()"><i class="fas fa-download"></i></button>
        </div>
    </header>

    <div class="workspace">
        
        <div class="palette-container" id="palette">
            </div>

        <div class="canvas-container" id="canvas-wrapper">
            <div id="svg-canvas">
                </div>
        </div>

    </div>

    <div class="modal-overlay" id="gallery-modal">
        <div class="gallery-modal">
            <div class="gallery-header">
                <h2>Ne Boyayalƒ±m? ü§î</h2>
                <div class="category-tabs">
                    <button class="cat-btn active" onclick="filterGallery('tasitlar')">Ta≈üƒ±tlar üöó</button>
                    <button class="cat-btn" onclick="filterGallery('hayvanlar')">Hayvanlar ü¶Å</button>
                    <button class="cat-btn" onclick="filterGallery('meyveler')">Meyveler üçé</button>
                </div>
            </div>
            <div class="gallery-content" id="gallery-grid">
                </div>
            <button class="close-modal-btn" onclick="closeGallery()">Kapat</button>
        </div>
    </div>

    <script>
        // --- VERƒ∞LER (SVG √áƒ∞Zƒ∞MLERƒ∞) ---
        // Basit, boyanabilir SVG kodlarƒ± (Path verileri)
        const categories = {
            tasitlar: [
                { name: "Araba", svg: '<path d="M10,60 L20,40 L70,40 L85,60 L90,60 L90,80 L10,80 Z" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="25" cy="80" r="10" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="70" cy="80" r="10" fill="#fff" stroke="#000" stroke-width="2"/>' },
                { name: "Roket", svg: '<path d="M50,10 Q30,40 30,70 L40,80 L50,70 L60,80 L70,70 Q70,40 50,10 Z" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="50" cy="40" r="8" fill="#fff" stroke="#000" stroke-width="2"/><path d="M30,70 L20,90 L35,80" fill="#fff" stroke="#000" stroke-width="2"/><path d="M70,70 L80,90 L65,80" fill="#fff" stroke="#000" stroke-width="2"/>' },
                { name: "U√ßak", svg: '<path d="M20,60 L40,60 L50,30 L60,30 L55,60 L90,60 L95,50 L100,50 L95,65 L95,70 L20,70 Q10,70 10,65 Q10,60 20,60 Z" fill="#fff" stroke="#000" stroke-width="2"/>' },
                { name: "Gemi", svg: '<path d="M20,60 L80,60 L70,90 L30,90 Z" fill="#fff" stroke="#000" stroke-width="2"/><rect x="45" y="30" width="10" height="30" fill="#fff" stroke="#000" stroke-width="2"/><path d="M45,30 L65,30 L45,45 Z" fill="#fff" stroke="#000" stroke-width="2"/>' }
            ],
            hayvanlar: [
                { name: "Kedi", svg: '<circle cx="50" cy="50" r="30" fill="#fff" stroke="#000" stroke-width="2"/><path d="M25,35 L25,10 L40,25 Z" fill="#fff" stroke="#000" stroke-width="2"/><path d="M75,35 L75,10 L60,25 Z" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="40" cy="45" r="3" fill="#000"/><circle cx="60" cy="45" r="3" fill="#000"/><path d="M45,55 Q50,60 55,55" fill="none" stroke="#000" stroke-width="2"/>' },
                { name: "Ayƒ±cƒ±k", svg: '<circle cx="50" cy="50" r="25" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="25" cy="25" r="10" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="75" cy="25" r="10" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="42" cy="45" r="3" fill="#000"/><circle cx="58" cy="45" r="3" fill="#000"/><ellipse cx="50" cy="55" rx="8" ry="6" fill="#fff" stroke="#000" stroke-width="1"/>' },
                { name: "Balƒ±k", svg: '<ellipse cx="50" cy="50" rx="30" ry="20" fill="#fff" stroke="#000" stroke-width="2"/><path d="M75,50 L95,35 L95,65 Z" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="35" cy="45" r="2" fill="#000"/>' },
                { name: "Kaplumbaƒüa", svg: '<path d="M30,60 Q50,30 70,60 Z" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="25" cy="65" r="8" fill="#fff" stroke="#000" stroke-width="2"/><rect x="30" y="60" width="40" height="10" fill="#fff" stroke="#000" stroke-width="2"/>' }
            ],
            meyveler: [
                { name: "Elma", svg: '<path d="M30,40 Q20,80 50,90 Q80,80 70,40 Q60,20 50,40 Q40,20 30,40 Z" fill="#fff" stroke="#000" stroke-width="2"/><path d="M50,40 L50,20" stroke="#000" stroke-width="3"/><path d="M50,25 Q60,15 65,25 Q60,35 50,25 Z" fill="#fff" stroke="#000" stroke-width="1"/>' },
                { name: "Muz", svg: '<path d="M20,80 Q50,90 80,40 Q85,30 80,25 Q75,20 70,30 Q50,70 30,70 L20,80 Z" fill="#fff" stroke="#000" stroke-width="2"/>' },
                { name: "Kiraz", svg: '<circle cx="35" cy="70" r="12" fill="#fff" stroke="#000" stroke-width="2"/><circle cx="65" cy="70" r="12" fill="#fff" stroke="#000" stroke-width="2"/><path d="M35,58 Q50,20 65,58" fill="none" stroke="#000" stroke-width="2"/><path d="M50,35 L60,25 Q55,20 50,25 Z" fill="#fff" stroke="#000" stroke-width="1"/>' },
                { name: "√áilek", svg: '<path d="M30,30 L50,90 L70,30 Q50,20 30,30 Z" fill="#fff" stroke="#000" stroke-width="2"/><path d="M30,30 L25,20 L35,25 L40,15 L50,25 L60,15 L65,25 L75,20 L70,30 Z" fill="#22c55e" stroke="#000" stroke-width="1"/>' }
            ]
        };

        const colors = [
            '#ef4444', '#f97316', '#f59e0b', '#eab308', '#84cc16', '#22c55e', 
            '#06b6d4', '#3b82f6', '#6366f1', '#a855f7', '#d946ef', '#ec4899', 
            '#78716c', '#000000', '#ffffff', '#fee2e2', '#ffedd5', '#fef3c7'
        ];

        let selectedColor = colors[0];
        const popSound = document.getElementById('pop-sound');

        // --- BA≈ûLATMA ---
        function init() {
            createPalette();
            // ƒ∞lk a√ßƒ±lƒ±≈üta Ta≈üƒ±tlar'dan Araba'yƒ± y√ºkle
            loadSVG(categories.tasitlar[0].svg);
            // Galeriyi "Ta≈üƒ±tlar" ile ba≈ülat
            filterGallery('tasitlar');
        }

        // --- RENK PALETƒ∞ OLU≈ûTUR ---
        function createPalette() {
            const container = document.getElementById('palette');
            colors.forEach((color, i) => {
                const swatch = document.createElement('div');
                swatch.className = `color-swatch ${i===0 ? 'active':''}`;
                swatch.style.backgroundColor = color;
                swatch.onclick = () => {
                    selectedColor = color;
                    document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
                    swatch.classList.add('active');
                };
                container.appendChild(swatch);
            });
        }

        // --- SVG Y√úKLEME VE BOYAMA MANTIƒûI ---
        function loadSVG(svgContent) {
            const canvas = document.getElementById('svg-canvas');
            // SVG'yi tam ekran ve ortalƒ± olacak ≈üekilde sarƒ±yoruz
            const wrapper = `<svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">${svgContent}</svg>`;
            canvas.innerHTML = wrapper;

            // Tƒ±klama Olaylarƒ±nƒ± Ekle
            const elements = canvas.querySelectorAll('path, circle, rect, polygon, ellipse');
            elements.forEach(el => {
                el.onclick = function() {
                    this.setAttribute('fill', selectedColor);
                    // Pop sesi √ßal (sessiz modda hata vermesin diye catch var)
                    popSound.currentTime = 0;
                    popSound.play().catch(e => {});
                    // Ufak animasyon
                    this.style.opacity = "0.5";
                    setTimeout(() => this.style.opacity = "1", 100);
                };
            });
            closeGallery();
        }

        // --- GALERƒ∞ Fƒ∞LTRELEME ---
        function filterGallery(categoryKey) {
            const grid = document.getElementById('gallery-grid');
            grid.innerHTML = ""; // Temizle
            
            // Butonlarƒ± g√ºncelle
            document.querySelectorAll('.cat-btn').forEach(btn => btn.classList.remove('active'));
            // Basƒ±lan butonu bulup active yap (Basit yol: text kontrol√º veya onclick g√ºncellemesi)
            // Burada basitlik adƒ±na butonlara onclick parametresi verdik.
            
            const items = categories[categoryKey];
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'gallery-item';
                div.innerHTML = `
                    <svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet">${item.svg}</svg>
                    <span>${item.name}</span>
                `;
                div.onclick = () => loadSVG(item.svg);
                grid.appendChild(div);
            });
        }

        function openGallery() { document.getElementById('gallery-modal').style.display = 'flex'; }
        function closeGallery() { document.getElementById('gallery-modal').style.display = 'none'; }

        // --- KAYDETME (RESƒ∞M OLARAK ƒ∞NDƒ∞R) ---
        function saveArt() {
            const node = document.getElementById('canvas-wrapper');
            htmlToImage.toPng(node, { backgroundColor: '#fff7ed' })
                .then(function (dataUrl) {
                    const link = document.createElement('a');
                    link.download = 'minik-ressam.png';
                    link.href = dataUrl;
                    link.click();
                })
                .catch(err => alert("Hata olu≈ütu, tekrar dene!"));
        }

        // Ba≈ülat
        init();

    </script>
</body>
</html>
