<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Konuşan Kartlar | İletişim Panosu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg: #f0f9ff; --strip: #ffffff; --card-bg: #fff; }
        
        body { margin: 0; font-family: 'Fredoka', sans-serif; background: var(--bg); height: 100vh; display: flex; flex-direction: column; overflow: hidden; user-select: none; }
        
        /* ÜST: CÜMLE BANDI (Sentence Strip) */
        .sentence-strip {
            background: var(--strip); padding: 10px; height: 100px; display: flex; align-items: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); z-index: 20; gap: 10px; position: relative;
        }
        
        .sentence-container {
            flex: 1; display: flex; gap: 8px; overflow-x: auto; padding: 5px; scroll-behavior: smooth;
            background: #f1f5f9; border-radius: 12px; height: 80px; align-items: center; border: 2px solid #e2e8f0;
        }
        
        .strip-card {
            background: white; border: 2px solid #3b82f6; border-radius: 8px; min-width: 70px; height: 70px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 0.8rem; font-weight: bold; animation: popIn 0.3s; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .strip-card i { font-size: 1.5rem; margin-bottom: 2px; color: #3b82f6; }
        
        .action-btn {
            width: 70px; height: 70px; border: none; border-radius: 12px; cursor: pointer; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; color: white; transition: 0.2s; flex-shrink: 0;
        }
        .btn-play { background: #22c55e; box-shadow: 0 4px 0 #15803d; }
        .btn-play:active { transform: translateY(4px); box-shadow: none; }
        .btn-clear { background: #ef4444; box-shadow: 0 4px 0 #b91c1c; }
        .btn-clear:active { transform: translateY(4px); box-shadow: none; }

        /* ORTA: KATEGORİLER */
        .categories { display: flex; gap: 10px; padding: 10px; overflow-x: auto; background: #e0f2fe; }
        .cat-btn {
            padding: 10px 20px; border: none; border-radius: 20px; background: white; 
            color: #334155; font-weight: bold; cursor: pointer; white-space: nowrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: 0.2s; border: 2px solid transparent;
        }
        .cat-btn.active { background: #3b82f6; color: white; transform: scale(1.05); }
        /* Kategori Renkleri */
        .cat-btn[data-cat="ihtiyac"].active { background: #ef4444; }
        .cat-btn[data-cat="yiyecek"].active { background: #f59e0b; }
        .cat-btn[data-cat="duygu"].active { background: #a855f7; }
        .cat-btn[data-cat="eylem"].active { background: #10b981; }
        .cat-btn[data-cat="ozne"].active { background: #64748b; }

        /* ALT: KART GRİD */
        .grid-container { flex: 1; overflow-y: auto; padding: 15px; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; align-content: start; }
        
        .card {
            background: white; border-radius: 15px; aspect-ratio: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: center; cursor: pointer; border-bottom: 5px solid #cbd5e1;
            transition: 0.1s; position: relative; overflow: hidden;
        }
        .card:active { border-bottom: 0; transform: translateY(5px); }
        .card i { font-size: 2.5rem; margin-bottom: 8px; }
        .card span { font-weight: bold; font-size: 1rem; text-align: center; line-height: 1.1; }
        
        /* Kart Renk Kodlaması (PECS Standartlarına Yakın) */
        .c-ozne i { color: #64748b; } .c-ozne { border-top: 4px solid #64748b; }
        .c-eylem i { color: #10b981; } .c-eylem { border-top: 4px solid #10b981; }
        .c-ihtiyac i { color: #ef4444; } .c-ihtiyac { border-top: 4px solid #ef4444; }
        .c-yiyecek i { color: #f59e0b; } .c-yiyecek { border-top: 4px solid #f59e0b; }
        .c-duygu i { color: #a855f7; } .c-duygu { border-top: 4px solid #a855f7; }

        /* Geri Butonu (Gizli gibi köşede) */
        .exit-btn { position: absolute; top: 10px; left: 10px; opacity: 0.3; z-index: 5; font-size: 0.8rem; }

        @keyframes popIn { 0% { transform: scale(0); } 80% { transform: scale(1.1); } 100% { transform: scale(1); } }
        
        /* ACİL BUTONU */
        .emergency-btn {
            position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px;
            background: #ef4444; border-radius: 50%; color: white; display: flex;
            align-items: center; justify-content: center; font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4); animation: pulse 2s infinite; cursor: pointer;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

    </style>
</head>
<body>

    <a href="ozel-egitim.html" class="exit-btn">Çıkış</a>

    <div class="sentence-strip">
        <button class="action-btn btn-clear" onclick="clearStrip()"><i class="fa-solid fa-trash"></i> SİL</button>
        <div class="sentence-container" id="strip"></div>
        <button class="action-btn btn-play" onclick="playSentence()"><i class="fa-solid fa-play"></i> OKU</button>
    </div>

    <div class="categories">
        <button class="cat-btn active" data-cat="ozne" onclick="filter('ozne', this)">Kişiler</button>
        <button class="cat-btn" data-cat="ihtiyac" onclick="filter('ihtiyac', this)">İhtiyaç</button>
        <button class="cat-btn" data-cat="yiyecek" onclick="filter('yiyecek', this)">Yiyecek</button>
        <button class="cat-btn" data-cat="duygu" onclick="filter('duygu', this)">Duygu</button>
        <button class="cat-btn" data-cat="eylem" onclick="filter('eylem', this)">Eylem</button>
    </div>

    <div class="grid-container" id="grid"></div>

    <div class="emergency-btn" onclick="speak('Yardım edin! Acil durum!'); alertEffect();">
        <i class="fa-solid fa-bell"></i>
    </div>

    <script>
        // KELİME VERİTABANI
        const db = [
            // ÖZNELER
            { id: 1, text: "Ben", icon: "fa-user", cat: "ozne" },
            { id: 2, text: "Sen", icon: "fa-hand-point-right", cat: "ozne" },
            { id: 3, text: "Anne", icon: "fa-person-dress", cat: "ozne" },
            { id: 4, text: "Baba", icon: "fa-person", cat: "ozne" },
            { id: 5, text: "Öğretmen", icon: "fa-chalkboard-user", cat: "ozne" },

            // İHTİYAÇLAR
            { id: 10, text: "Su", icon: "fa-glass-water", cat: "ihtiyac" },
            { id: 11, text: "Tuvalet", icon: "fa-toilet", cat: "ihtiyac" },
            { id: 12, text: "Uyku", icon: "fa-bed", cat: "ihtiyac" },
            { id: 13, text: "Tablet", icon: "fa-tablet-screen-button", cat: "ihtiyac" },
            { id: 14, text: "Oyuncak", icon: "fa-robot", cat: "ihtiyac" },

            // YİYECEKLER
            { id: 20, text: "Elma", icon: "fa-apple-whole", cat: "yiyecek" },
            { id: 21, text: "Ekmek", icon: "fa-bread-slice", cat: "yiyecek" },
            { id: 22, text: "Çikolata", icon: "fa-cookie", cat: "yiyecek" },
            { id: 23, text: "Süt", icon: "fa-bottle-droplet", cat: "yiyecek" },
            { id: 24, text: "Yemek", icon: "fa-utensils", cat: "yiyecek" },

            // DUYGULAR
            { id: 30, text: "Mutlu", icon: "fa-face-smile", cat: "duygu" },
            { id: 31, text: "Üzgün", icon: "fa-face-sad-tear", cat: "duygu" },
            { id: 32, text: "Kızgın", icon: "fa-face-angry", cat: "duygu" },
            { id: 33, text: "Yorgun", icon: "fa-face-tired", cat: "duygu" },
            { id: 34, text: "Korkmuş", icon: "fa-face-flushed", cat: "duygu" },

            // EYLEMLER
            { id: 40, text: "İstiyorum", icon: "fa-hand-holding-heart", cat: "eylem" },
            { id: 41, text: "Git", icon: "fa-person-walking-arrow-right", cat: "eylem" },
            { id: 42, text: "Gel", icon: "fa-person-walking-arrow-loop-left", cat: "eylem" },
            { id: 43, text: "Oyna", icon: "fa-shapes", cat: "eylem" },
            { id: 44, text: "Dur", icon: "fa-hand", cat: "eylem" },
            { id: 45, text: "Sev", icon: "fa-heart", cat: "eylem" }
        ];

        let sentence = [];
        const synth = window.speechSynthesis;

        // BAŞLANGIÇ
        window.onload = () => {
            filter('ozne', document.querySelector('.cat-btn'));
        };

        // KATEGORİ FİLTRELEME
        function filter(category, btn) {
            // Buton stili
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');

            // Grid render
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            
            const items = db.filter(i => i.cat === category);
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = `card c-${item.cat}`;
                div.innerHTML = `<i class="fa-solid ${item.icon}"></i><span>${item.text}</span>`;
                div.onclick = () => addToStrip(item);
                grid.appendChild(div);
            });
        }

        // CÜMLE BANDINA EKLEME
        function addToStrip(item) {
            sentence.push(item.text);
            speak(item.text);
            renderStrip();
        }

        function renderStrip() {
            const strip = document.getElementById('strip');
            strip.innerHTML = "";
            sentence.forEach((word) => {
                // İkonu bul
                const item = db.find(i => i.text === word);
                const iconClass = item ? item.icon : 'fa-comment';
                
                const div = document.createElement('div');
                div.className = "strip-card";
                div.innerHTML = `<i class="fa-solid ${iconClass}"></i><span>${word}</span>`;
                strip.appendChild(div);
            });
            // Sona kaydır
            strip.scrollLeft = strip.scrollWidth;
        }

        // CÜMLEYİ OKU
        function playSentence() {
            if(sentence.length === 0) return;
            const fullText = sentence.join(" ");
            speak(fullText);
        }

        // TEMİZLE
        function clearStrip() {
            sentence = [];
            renderStrip();
            speak("Temizlendi");
        }

        // TTS (SESLİ OKUMA) MOTORU
        function speak(text) {
            if (synth.speaking) {
                synth.cancel();
            }
            const utterThis = new SpeechSynthesisUtterance(text);
            utterThis.lang = 'tr-TR';
            utterThis.rate = 0.9; // Biraz yavaş ve anlaşılır
            synth.speak(utterThis);
        }

        // ACİL DURUM EFEKTİ
        function alertEffect() {
            document.body.style.backgroundColor = "#fee2e2";
            setTimeout(() => document.body.style.backgroundColor = "var(--bg)", 500);
        }

    </script>
</body>
</html>
