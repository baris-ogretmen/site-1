<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mars Kaşifi | Barış Öğretmen</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg-dark: #0b1120; --neon-blue: #0ea5e9; --neon-green: #22c55e; --neon-red: #ef4444; --glass: rgba(30, 41, 59, 0.8); }
        body { margin: 0; background: var(--bg-dark); color: #e2e8f0; font-family: 'Rajdhani', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; user-select: none; }
        
        /* HEADER */
        header { background: rgba(15, 23, 42, 0.9); padding: 15px 20px; border-bottom: 2px solid var(--neon-blue); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 0 20px rgba(14, 165, 233, 0.2); }
        h1 { font-family: 'Orbitron', sans-serif; margin: 0; font-size: 1.5rem; color: var(--neon-blue); letter-spacing: 2px; }
        .level-badge { background: var(--neon-blue); color: #000; padding: 5px 15px; border-radius: 5px; font-weight: bold; font-family: 'Orbitron', sans-serif; }
        .back-btn { color: #fff; text-decoration: none; border: 1px solid #fff; padding: 5px 15px; border-radius: 5px; font-size: 0.9rem; transition:0.3s; }
        .back-btn:hover { background: #fff; color: #000; }

        /* OYUN ALANI (GRID) */
        .main-container { flex: 1; display: flex; padding: 20px; gap: 20px; height: 100%; box-sizing: border-box; }
        
        .game-board { flex: 2; background: radial-gradient(circle, #1e293b 0%, #0f172a 100%); border: 2px solid var(--neon-blue); border-radius: 15px; display: grid; grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr); gap: 2px; padding: 10px; position: relative; box-shadow: inset 0 0 50px rgba(0,0,0,0.5); }
        
        .cell { border: 1px solid rgba(14, 165, 233, 0.1); border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 2rem; position: relative; }
        .cell.obstacle { background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); }
        .cell.finish { background: rgba(34, 197, 94, 0.1); border: 1px solid var(--neon-green); box-shadow: 0 0 15px rgba(34, 197, 94, 0.3); }
        
        /* ROBOT */
        .robot { font-size: 2.5rem; color: var(--neon-blue); filter: drop-shadow(0 0 10px var(--neon-blue)); transition: all 0.5s ease; position: absolute; z-index: 10; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; }

        /* KONTROL PANELİ */
        .control-panel { flex: 1; background: var(--glass); border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; padding: 20px; gap: 15px; backdrop-filter: blur(10px); }
        
        .screen-title { font-family: 'Orbitron', sans-serif; color: var(--neon-green); font-size: 1.1rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px; margin-bottom: 10px; }

        /* KOMUT SIRASI */
        .command-queue { background: #000; height: 60px; border-radius: 8px; border: 1px solid var(--neon-blue); display: flex; align-items: center; padding: 0 10px; gap: 5px; overflow-x: auto; margin-bottom: 10px; box-shadow: inset 0 0 10px rgba(14, 165, 233, 0.3); }
        .cmd-icon { width: 30px; height: 30px; background: #334155; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: #fff; flex-shrink: 0; animation: popIn 0.3s; }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }

        /* BUTONLAR */
        .buttons-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .ctrl-btn { background: #1e293b; border: 1px solid var(--neon-blue); color: var(--neon-blue); padding: 15px; border-radius: 10px; cursor: pointer; font-family: 'Orbitron', sans-serif; font-size: 1.2rem; transition: 0.2s; }
        .ctrl-btn:hover { background: var(--neon-blue); color: #000; box-shadow: 0 0 15px var(--neon-blue); }
        .ctrl-btn:active { transform: scale(0.95); }

        .run-btn { background: var(--neon-green); color: #000; border: none; font-weight: bold; grid-column: span 3; margin-top: 10px; }
        .run-btn:hover { background: #4ade80; box-shadow: 0 0 15px var(--neon-green); }
        
        .reset-btn { background: var(--neon-red); color: #fff; border: none; grid-column: span 3; font-size: 1rem; padding: 10px; }

        /* SİSTEM LOGU (TERMİNAL) */
        .system-log { background: #000; flex: 1; border-radius: 8px; border: 1px solid #334155; padding: 10px; font-family: 'Courier New', monospace; font-size: 0.85rem; color: var(--neon-green); overflow-y: auto; opacity: 0.8; }
        .log-line { margin-bottom: 5px; border-bottom: 1px solid rgba(255,255,255,0.05); }

        /* MOBİL UYUM */
        @media (max-width: 768px) {
            .main-container { flex-direction: column; }
            .game-board { min-height: 300px; }
            .control-panel { min-height: 300px; }
        }
    </style>
</head>
<body>

    <header>
        <a href="robotik.html" class="back-btn"><i class="fas fa-arrow-left"></i> ÇIKIŞ</a>
        <h1>MARS KAŞİFİ</h1>
        <div class="level-badge" id="level-display">SEVİYE 1</div>
    </header>

    <div class="main-container">
        <div class="game-board" id="game-board"></div>

        <div class="control-panel">
            <div class="screen-title"><i class="fas fa-code"></i> KOMUT PANELİ</div>
            
            <div class="command-queue" id="command-queue">
                </div>

            <div class="buttons-grid">
                <button class="ctrl-btn" onclick="addCommand('L')"><i class="fas fa-undo"></i></button>
                <button class="ctrl-btn" onclick="addCommand('F')"><i class="fas fa-arrow-up"></i></button>
                <button class="ctrl-btn" onclick="addCommand('R')"><i class="fas fa-redo"></i></button>
                
                <button class="ctrl-btn run-btn" onclick="runCode()"><i class="fas fa-play"></i> ÇALIŞTIR</button>
                <button class="ctrl-btn reset-btn" onclick="resetLevel()"><i class="fas fa-trash"></i> TEMİZLE</button>
            </div>

            <div class="screen-title" style="margin-top:15px;"><i class="fas fa-terminal"></i> SİSTEM LOGU</div>
            <div class="system-log" id="system-log">
                <div class="log-line">> Sistem başlatıldı...</div>
                <div class="log-line">> Hedef: Yeşil alana ulaş.</div>
            </div>
        </div>
    </div>

    <script>
        // OYUN AYARLARI
        const gridSize = 6;
        let robot = { x: 0, y: 0, dir: 0 }; // 0: Kuzey, 1: Doğu, 2: Güney, 3: Batı
        let commands = [];
        let isRunning = false;
        let currentLevelIndex = 0;

        // SEVİYELER (Start: Başlangıç, End: Bitiş, Walls: Engeller)
        const levels = [
            { start: [0,0], end: [0,4], walls: [[0,2], [1,2], [2,2]] }, // Seviye 1
            { start: [5,0], end: [0,5], walls: [[4,0], [4,1], [4,2], [2,3], [2,4], [2,5]] }, // Seviye 2
            { start: [0,0], end: [5,5], walls: [[1,1], [3,3], [4,4], [1,4], [4,1], [2,2], [5,2]] } // Seviye 3
        ];

        // LOG YAZDIRMA
        function log(msg, type = 'normal') {
            const logBox = document.getElementById('system-log');
            const color = type === 'error' ? 'var(--neon-red)' : type === 'success' ? 'var(--neon-blue)' : 'var(--neon-green)';
            logBox.innerHTML += `<div class="log-line" style="color:${color}">> ${msg}</div>`;
            logBox.scrollTop = logBox.scrollHeight;
        }

        // TAHTAYI ÇİZ
        function drawBoard() {
            const board = document.getElementById('game-board');
            board.innerHTML = '';
            const level = levels[currentLevelIndex];

            // Hücreleri Oluştur
            for (let y = 0; y < gridSize; y++) {
                for (let x = 0; x < gridSize; x++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    cell.dataset.x = x;
                    cell.dataset.y = y;

                    // Bitiş Noktası
                    if (x === level.end[0] && y === level.end[1]) {
                        cell.classList.add('finish');
                        cell.innerHTML = '<i class="fas fa-flag-checkered" style="color:var(--neon-green); font-size:1.5rem;"></i>';
                    }

                    // Engeller
                    if (level.walls.some(w => w[0] === x && w[1] === y)) {
                        cell.classList.add('obstacle');
                        cell.innerHTML = '<i class="fas fa-meteor" style="color:var(--neon-red); font-size:1.5rem;"></i>';
                    }

                    board.appendChild(cell);
                }
            }
            updateRobotVisual();
            document.getElementById('level-display').innerText = `SEVİYE ${currentLevelIndex + 1}`;
        }

        // ROBOTU GÖRSEL OLARAK GÜNCELLE
        function updateRobotVisual() {
            // Önceki robotu sil
            const oldRobot = document.querySelector('.robot');
            if (oldRobot) oldRobot.remove();

            // Yeni robotu bul ve ekle
            const cells = document.querySelectorAll('.cell');
            const targetCell = Array.from(cells).find(c => c.dataset.x == robot.x && c.dataset.y == robot.y);
            
            if (targetCell) {
                const robotEl = document.createElement('div');
                robotEl.classList.add('robot');
                robotEl.innerHTML = '<i class="fas fa-robot"></i>';
                robotEl.style.transform = `rotate(${robot.dir * 90}deg)`;
                targetCell.appendChild(robotEl);
            }
        }

        // KOMUT EKLE
        function addCommand(cmd) {
            if (isRunning) return;
            commands.push(cmd);
            const queue = document.getElementById('command-queue');
            let icon = cmd === 'F' ? 'fa-arrow-up' : cmd === 'L' ? 'fa-undo' : 'fa-redo';
            queue.innerHTML += `<div class="cmd-icon"><i class="fas ${icon}"></i></div>`;
            log(`Komut eklendi: ${cmd}`);
        }

        // KODU ÇALIŞTIR
        async function runCode() {
            if (isRunning || commands.length === 0) return;
            isRunning = true;
            log('Kod yürütülüyor...', 'success');

            for (let cmd of commands) {
                await new Promise(r => setTimeout(r, 600)); // Bekleme süresi
                
                if (cmd === 'L') {
                    robot.dir = (robot.dir + 3) % 4; // Sola dön
                    log('Sola dönüldü.');
                } else if (cmd === 'R') {
                    robot.dir = (robot.dir + 1) % 4; // Sağa dön
                    log('Sağa dönüldü.');
                } else if (cmd === 'F') {
                    moveForward();
                }
                updateRobotVisual();
                
                // Kontrol: Çarpma veya Bitiş
                if (checkCollision()) {
                    log('HATA: Engele çarpıldı veya alan dışı!', 'error');
                    alert('ÇARPIŞMA! Robot hasar gördü.');
                    resetLevel();
                    return;
                }

                if (checkWin()) {
                    log('BAŞARILI: Hedefe ulaşıldı!', 'success');
                    await new Promise(r => setTimeout(r, 500));
                    alert('TEBRİKLER! Seviye tamamlandı.');
                    nextLevel();
                    return;
                }
            }
            
            isRunning = false;
            log('Komutlar bitti. Hedefe ulaşılamadı.', 'error');
            setTimeout(() => {
                 if (!checkWin()) resetLevel();
            }, 1000);
        }

        // İLERİ GİTME MANTIĞI
        function moveForward() {
            let nextX = robot.x;
            let nextY = robot.y;

            if (robot.dir === 0) nextY--; // Kuzey (Yukarı)
            if (robot.dir === 1) nextX++; // Doğu (Sağ)
            if (robot.dir === 2) nextY++; // Güney (Aşağı)
            if (robot.dir === 3) nextX--; // Batı (Sol)

            robot.x = nextX;
            robot.y = nextY;
            log(`İleri gidildi. Konum: [${robot.x},${robot.y}]`);
        }

        // ÇARPIŞMA KONTROLÜ
        function checkCollision() {
            const level = levels[currentLevelIndex];
            // Alan dışı mı?
            if (robot.x < 0 || robot.x >= gridSize || robot.y < 0 || robot.y >= gridSize) return true;
            // Duvar mı?
            if (level.walls.some(w => w[0] === robot.x && w[1] === robot.y)) return true;
            return false;
        }

        // KAZANMA KONTROLÜ
        function checkWin() {
            const level = levels[currentLevelIndex];
            return robot.x === level.end[0] && robot.y === level.end[1];
        }

        // SEVİYE SIFIRLA
        function resetLevel() {
            isRunning = false;
            commands = [];
            document.getElementById('command-queue').innerHTML = '';
            const level = levels[currentLevelIndex];
            robot.x = level.start[0];
            robot.y = level.start[1];
            robot.dir = 1; // Başlangıç yönü Doğu
            log('Sistem sıfırlandı.');
            updateRobotVisual();
        }

        // SONRAKİ SEVİYE
        function nextLevel() {
            if (currentLevelIndex < levels.length - 1) {
                currentLevelIndex++;
                resetLevel();
                drawBoard();
            } else {
                alert('TÜM GÖREVLER TAMAMLANDI! Usta bir pilotsun!');
                currentLevelIndex = 0;
                resetLevel();
                drawBoard();
            }
        }

        // BAŞLAT
        resetLevel();
        drawBoard();

    </script>
</body>
</html>
